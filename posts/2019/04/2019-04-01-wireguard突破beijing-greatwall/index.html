<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="有好几个月没有写blog了，原因也挺多的。首先过年嘛，一直有点懒散，然后整天写业务代码又无聊又忙，实际可记录的东西本来也不多，又懒的记。一些新工具啥的，感觉记了也没什么意义，反正都记脑子里了。最近读了一些经典框架源码，学了一些源码课程，也挺有一些收获，不过这样的东西更喜欢记实体笔记一些。综上，总而言之挺久没记blog了。\n最近Beijing的伟大长城也是越来越狠了，我的ss从一开始的稳定，居然变得不能用了。每次都是刚开始能有连接信息，然后一小会之后，直接telnet都不通了，包括22和ss的端口都断了。换了几十个ip也不管用，port换了无数个，也不管用。\n特别是这几周因为贫穷的原因被迫搬家，租到了一个鸟不拉屎的地方，连联通都没得办，非得办啥长城宽带，一听这名字就不是啥好鸟，果然，有了the great wall，你想探头出去看看，不可能的。\n但平时下班和周末休息的时候没法翻墙实在是太痛苦了，我尝试了很多种办法之后，找到了一个相对好的方式解决了这个问题，那就是这篇blog的主题了，WireGuard VPN。\n"><title>WireGuard突破BeiJing GreatWall</title><link rel=canonical href=https://www.calmkart.com/posts/2019/04/2019-04-01-wireguard%E7%AA%81%E7%A0%B4beijing-greatwall/><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap"><link rel=stylesheet href=/scss/style.min.390cc81d180d80110703ea467e355a4f3a0f44f25d4e957842790824fb5f2ef2.css><meta property='og:title' content="WireGuard突破BeiJing GreatWall"><meta property='og:description' content="有好几个月没有写blog了，原因也挺多的。首先过年嘛，一直有点懒散，然后整天写业务代码又无聊又忙，实际可记录的东西本来也不多，又懒的记。一些新工具啥的，感觉记了也没什么意义，反正都记脑子里了。最近读了一些经典框架源码，学了一些源码课程，也挺有一些收获，不过这样的东西更喜欢记实体笔记一些。综上，总而言之挺久没记blog了。\n最近Beijing的伟大长城也是越来越狠了，我的ss从一开始的稳定，居然变得不能用了。每次都是刚开始能有连接信息，然后一小会之后，直接telnet都不通了，包括22和ss的端口都断了。换了几十个ip也不管用，port换了无数个，也不管用。\n特别是这几周因为贫穷的原因被迫搬家，租到了一个鸟不拉屎的地方，连联通都没得办，非得办啥长城宽带，一听这名字就不是啥好鸟，果然，有了the great wall，你想探头出去看看，不可能的。\n但平时下班和周末休息的时候没法翻墙实在是太痛苦了，我尝试了很多种办法之后，找到了一个相对好的方式解决了这个问题，那就是这篇blog的主题了，WireGuard VPN。\n"><meta property='og:url' content='https://www.calmkart.com/posts/2019/04/2019-04-01-wireguard%E7%AA%81%E7%A0%B4beijing-greatwall/'><meta property='og:site_name' content='cAlm的个人Blog'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='shadowsocks'><meta property='article:tag' content='vpn'><meta property='article:tag' content='翻墙'><meta property='article:published_time' content='2019-04-01T00:00:00+00:00'><meta property='article:modified_time' content='2019-04-01T00:00:00+00:00'><meta name=twitter:title content="WireGuard突破BeiJing GreatWall"><meta name=twitter:description content="有好几个月没有写blog了，原因也挺多的。首先过年嘛，一直有点懒散，然后整天写业务代码又无聊又忙，实际可记录的东西本来也不多，又懒的记。一些新工具啥的，感觉记了也没什么意义，反正都记脑子里了。最近读了一些经典框架源码，学了一些源码课程，也挺有一些收获，不过这样的东西更喜欢记实体笔记一些。综上，总而言之挺久没记blog了。\n最近Beijing的伟大长城也是越来越狠了，我的ss从一开始的稳定，居然变得不能用了。每次都是刚开始能有连接信息，然后一小会之后，直接telnet都不通了，包括22和ss的端口都断了。换了几十个ip也不管用，port换了无数个，也不管用。\n特别是这几周因为贫穷的原因被迫搬家，租到了一个鸟不拉屎的地方，连联通都没得办，非得办啥长城宽带，一听这名字就不是啥好鸟，果然，有了the great wall，你想探头出去看看，不可能的。\n但平时下班和周末休息的时候没法翻墙实在是太痛苦了，我尝试了很多种办法之后，找到了一个相对好的方式解决了这个问题，那就是这篇blog的主题了，WireGuard VPN。\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/>cAlm的个人Blog</a></h1><h2 class=site-description>随手记录些东西</h2></div></header><ol class=menu id=main-menu><li><a href=/><span>首页</span></a></li><li><a href=/archives><span>归档</span></a></li><li><a href=/categories><span>分类</span></a></li><li><a href=/about><span>关于</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/ style=background-color:#bed8ef;color:#0f283d>计算机</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/2019/04/2019-04-01-wireguard%E7%AA%81%E7%A0%B4beijing-greatwall/>WireGuard突破BeiJing GreatWall</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2019-04-01T00:00:00Z>Monday, April 1, 2019</time></div></footer></div></header><section class=article-content><p>有好几个月没有写blog了，原因也挺多的。首先过年嘛，一直有点懒散，然后整天写业务代码又无聊又忙，实际可记录的东西本来也不多，又懒的记。一些新工具啥的，感觉记了也没什么意义，反正都记脑子里了。最近读了一些经典框架源码，学了一些源码课程，也挺有一些收获，不过这样的东西更喜欢记实体笔记一些。综上，总而言之挺久没记blog了。</p><p>最近Beijing的伟大长城也是越来越狠了，我的ss从一开始的稳定，居然变得不能用了。每次都是刚开始能有连接信息，然后一小会之后，直接telnet都不通了，包括22和ss的端口都断了。换了几十个ip也不管用，port换了无数个，也不管用。</p><p>特别是这几周因为贫穷的原因被迫搬家，租到了一个鸟不拉屎的地方，连联通都没得办，非得办啥长城宽带，一听这名字就不是啥好鸟，果然，有了the great wall，你想探头出去看看，不可能的。</p><p>但平时下班和周末休息的时候没法翻墙实在是太痛苦了，我尝试了很多种办法之后，找到了一个相对好的方式解决了这个问题，那就是这篇blog的主题了，WireGuard VPN。</p><p>wireguard是一种比较新的vpn，基于udp，速度可以说秒杀其他vpn(实测体验)，体验几乎不逊色于ss。</p><p>并且wireguard配置简单，客户端易用，被集成进了linux内核，也许可以说比ss安全(这点我不确定，但是我的服务器确实ss被全面封杀，但是wireguard用起来轻松愉快)。</p><p>所以，很推荐现在用不了ss的朋友试试这个新东西，下面开始配置过程。</p><p> </p><p>首先配置服务端</p><pre tabindex=0><code>#推荐使用一键安装脚本,github地址
https://github.com/l-n-s/wireguard-install
#过程
wget https://raw.githubusercontent.com/l-n-s/wireguard-install/master/wireguard-install.sh -O wireguard-install.sh
bash wireguard-install.sh

#然后输入下确定啥的（dns记得选择google的8.8.8.8,4.4.4.4，比较靠谱），你以为一切就ok了，然而一般并不是，你会报错，说啥服务没起来。
#你用systemctl status wg-quick@wg0.service查看一下到底除了啥问题，发现是ip link add dev wg0 type wireguard命令起不来
#再次尝试手动ip link add dev wg0 type wireguard，发现报错，找不到wireguard类型的网卡设备名
#查询了一下，原来是linux内核版本和linux-headers的问题，那么好办了，先更新下内核版本吧
apt-get install linux-image-4.9.0.8-amd64
#然后删除旧版本的linux内核
apt-get remove linux-image-4.x.x.x-amd64
#接着记得安装好对应版本的linux-headers
apt-get install linux-headers-4.9.0.8-amd64
#然后重启
reboot
#重启完成后手动启动wireguard网卡
ip link add dev wg0 type wireguard
#发现启动成功,这就很棒棒了
#现在重启服务吧
systemctl restart wg-quick@wg0.service
#查看服务状态
systemctl status wg-quick@wg0.service
#很棒棒，又成功了，你得到它了

#然后生成客户端配置文件
wg showconf wg0
#客户端配置文件将自动生成为/etc/wireguard/wg0.conf
</code></pre><p>服务端这就已经配置完毕了，接着配置客户端(客户端用的Tunsafe，下载在文末)</p><pre tabindex=0><code>#将客户端配置文件下载到自己的机器上(客户端),观察下配置文件的内容，其实也挺简单的，就是用rsa公私钥加密通信而已。
#在客户端修改配置文件
[Peer]
#添加
Endpoint = [服务端ip地址]:[服务端配置的ip端口号]
#配置文件也搞定了。
#客户端使用TunSafe，记得使用前需要先安装环境配置
#点击import,导入下载下来的配置文件
#然后点击connect即可
enjoy it
</code></pre><p> </p><p>总的来说，用了也一段时间了，wireguard的稳定性和可靠性还是很棒的，但是还是有些缺点。</p><p>比如因为是vpn所以没法像ss一样针对流量做分流，都是用的全局流量。其次，wireguard是用的rsa公私钥做加密的，单配置只针对单用户，需要多人连接需要在服务端配置多用户，也不是那么方便，而且流量管理啥的好像也没啥现成的东西。而且速度确实还是逊色于ss的。(当然，ss现在的封锁力度太大啦。)</p><p>好的，就到这里了。</p><p>附上tunsafe客户端，方便上不了tunsafe官网的朋友(记得先安装其中的ts环境)</p><p><a class=link href=http://www.calmkart.com/wp-content/uploads/2019/04/TunSafe.zip target=_blank rel=noopener>TunSafe</a></p><hr><h2 id=历史评论-5-条>历史评论 (5 条)</h2><p><em>以下评论来自原 WordPress 站点，仅作存档展示。</em></p><blockquote><p><strong>liuxing</strong> (2019-04-10 16:10)</p><p>大神，请问下苹果笔记本怎么用这个软件翻墙啊？</p></blockquote><blockquote><p>↳ <strong>calmkart</strong> (2019-04-14 11:21)</p><p>服务端配好了同样用tunsafe客户端就行了啊,tunsafe客户端有MAC版本的</p></blockquote><blockquote><p><strong>huan</strong> (2019-04-29 17:01)</p><p>学习了，幸好我远离帝都</p></blockquote><blockquote><p>↳ <strong>calmkart</strong> (2019-04-30 10:50)</p><p>安全王？贵司应该就是用的stunnel+sniproxy+dns劫持翻墙的,讲道理还是不太安全</p></blockquote><pre><code>&gt; ↳ **huan** (2019-05-09 09:49)
&gt;
&gt; 没那么高端，直接是调整出口的路由到香港线路。
&gt; 我最近都是v2ray，感觉也很稳，被封了就试下wireguard
</code></pre></section><footer class=article-footer><section class=article-tags><a href=/tags/shadowsocks/>Shadowsocks</a>
<a href=/tags/vpn/>Vpn</a>
<a href=/tags/%E7%BF%BB%E5%A2%99/>翻墙</a></section></footer></article><div id=tcomment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.39/dist/twikoo.all.min.js></script><script>twikoo.init({envId:"calmblog.vercel.app",el:"#tcomment",lang:"zh-CN"})</script><footer class=site-footer><section class=copyright>&copy;
2026 cAlm的个人Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=4.0.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><script type=module>
    import gallery from '\/ts\/gallery.js';

    const articleContent = document.querySelector('.article-content');
    const shouldLoad = articleContent && (articleContent.querySelectorAll('figure').length > 0 || articleContent.querySelectorAll('img.gallery-image').length > 0);
    
    if (shouldLoad) {
        gallery(articleContent);

        const PhotoSwipeLightbox = (await import("https:\/\/cdn.jsdelivr.net\/npm\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js")).default;
        const styleHref = "https:\/\/cdn.jsdelivr.net\/npm\/photoswipe@5.4.4\/dist\/photoswipe.css";

        const styleTag = document.createElement('link');
        styleTag.rel = 'stylesheet';
        styleTag.href = styleHref;
        document.head.appendChild(styleTag);

        const lightbox = new PhotoSwipeLightbox({
            gallerySelector: '.article-content',
            childSelector: 'figure a.image-link',
            pswpModule: () => import("https:\/\/cdn.jsdelivr.net\/npm\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js")
        });
        lightbox.init();
    }
</script></main></div><script type=text/javascript src=/ts/main.acaf849f2b273f6a8368a58b001f336738d0c948d92e79b116467d0c7515f932.js defer></script></body></html>