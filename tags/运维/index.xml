<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>è¿ç»´ on cAlmçš„ä¸ªäººBlog</title><link>https://www.calmkart.com/tags/%E8%BF%90%E7%BB%B4/</link><description>Recent content in è¿ç»´ on cAlmçš„ä¸ªäººBlog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 25 Dec 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://www.calmkart.com/tags/%E8%BF%90%E7%BB%B4/index.xml" rel="self" type="application/rss+xml"/><item><title>çäº‹ç¹å¤šæ˜¯ä¸æ˜¯ä¸€å®šä¸å¥½?</title><link>https://www.calmkart.com/posts/2019/12/2019-12-25-%E7%90%90%E4%BA%8B%E7%B9%81%E5%A4%9A%E6%98%AF%E4%B8%8D%E6%98%AF%E4%B8%80%E5%AE%9A%E4%B8%8D%E5%A5%BD/</link><pubDate>Wed, 25 Dec 2019 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2019/12/2019-12-25-%E7%90%90%E4%BA%8B%E7%B9%81%E5%A4%9A%E6%98%AF%E4%B8%8D%E6%98%AF%E4%B8%80%E5%AE%9A%E4%B8%8D%E5%A5%BD/</guid><description>&lt;p&gt;æ‘˜æŠ„è‡ª ã€ŠSRE: Googleè¿ç»´è§£å¯†ã€‹&lt;/p&gt;
&lt;p&gt;å­—å­—ç ç‘ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;çäº‹ä¸ä¼šæ€»æ˜¯è®©æ¯ä¸ªäººéƒ½ä¸å¼€å¿ƒï¼Œç‰¹åˆ«æ˜¯ä¸å¤ªå¤šçš„æ—¶å€™ã€‚å·²çŸ¥çš„å’Œé‡å¤æ€§çš„å·¥ä½œæœ‰ä¸€ç§è®©äººå¹³é™çš„åŠŸæ•ˆã€‚å®Œæˆè¿™äº›äº‹å¯ä»¥å¸¦æ¥ä¸€ç§æ»¡è¶³æ„Ÿå’Œå¿«é€Ÿèƒœåˆ©æ„Ÿã€‚çäº‹å¯èƒ½æ˜¯ä½é£é™©ä½å‹åŠ›çš„æ´»åŠ¨ï¼Œæœ‰äº›å‘˜å·¥ç”šè‡³å–œæ¬¢åšè¿™ç§ç±»å‹çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;çäº‹çš„å­˜åœ¨å¹¶ä¸æ€»æ˜¯åäº‹ï¼Œä½†æ˜¯æ¯ä¸ªäººéƒ½å¿…é¡»æ¸…æ¥šï¼Œåœ¨SREæ‰€æ‰®æ¼”çš„è§’è‰²ä¸­ï¼Œä¸€å®šæ•°é‡çš„çäº‹æ˜¯ä¸å¯é¿å…çš„ï¼Œè¿™å…¶å®æ˜¯ä»»ä½•å·¥ç¨‹ç±»å·¥ä½œéƒ½å…·æœ‰çš„ç‰¹ç‚¹ã€‚å°‘é‡çš„çäº‹å­˜åœ¨ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ã€‚ä½†æ˜¯ä¸€æ—¦çäº‹çš„æ•°é‡å˜å¤šï¼Œå°±ä¼šæœ‰å®³äº†ã€‚å¦‚æœçäº‹ç‰¹åˆ«ç¹é‡ï¼Œé‚£å°±åº”è¯¥éå¸¸æ‹…æ‰°ï¼Œå¤§å£°æŠ±æ€¨ã€‚åœ¨è®¸å¤šçäº‹æœ‰å®³çš„åŸå› ä¸­ï¼Œæœ‰å¦‚ä¸‹å› ç´ éœ€è¦è€ƒè™‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;èŒä¸šåœæ»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœèŠ±åœ¨å·¥ç¨‹é¡¹ç›®ä¸Šçš„æ—¶é—´å¤ªå°‘ï¼Œä½ çš„èŒä¸šå‘å±•ä¼šå˜æ…¢ï¼Œç”šè‡³åœæ»ã€‚Googleç¡®å®ä¼šå¥–åŠ±åšé‚£äº›è„æ´»ç´¯æ´»çš„äººï¼Œä½†æ˜¯ä»…ä»…æ˜¯è¯¥å·¥ä½œæ˜¯ä¸å¯é¿å…ï¼Œå¹¶æœ‰å·¨å¤§çš„æ­£é¢å½±å“çš„æ—¶å€™æ‰ä¼šè¿™æ ·åšã€‚æ²¡æœ‰äººå¯ä»¥é€šè¿‡ä¸åœåœ°åšè„æ´»ç´¯æ´»æ»¡è¶³è‡ªå·±çš„èŒä¸šå‘å±•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å£«æ°”ä½è½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªäººå¯¹è‡ªå·±å¯ä»¥æ‰¿æ‹…çš„çäº‹é™åº¦æœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯ä¸€å®šæœ‰ä¸ªé™åº¦ã€‚è¿‡å¤šçš„çäº‹ä¼šå¯¼è‡´è¿‡åº¦åŠ³ç´¯ï¼Œç–²å€¦å’Œä¸æ»¡ã€‚&lt;/p&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œç‰ºç‰²å·¥ç¨‹å®è·µè€Œåšçäº‹ä¼šå¯¹SREç»„ç»‡çš„æ•´ä½“å‘å±•é€ æˆæŸå®³ï¼ŒåŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é€ æˆè¯¯è§£&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åŠªåŠ›ç¡®ä¿æ¯ä¸ªSREä»¥åŠä¸SREä¸€èµ·å·¥ä½œçš„äººéƒ½ç†è§£SREæ˜¯ä¸€ä¸ªå·¥ç¨‹ç»„ç»‡ã€‚å¦‚æœä¸ªäººæˆ–å›¢é˜Ÿè¿‡åº¦å‚ä¸çäº‹ï¼Œä¼šç ´åè¿™ç§è§’è‰²ï¼Œé€ æˆè¯¯è§£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿›å±•ç¼“æ…¢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;çäº‹è¿‡å¤šä¼šå¯¼è‡´å›¢é˜Ÿç”Ÿäº§åŠ›ä¸‹é™ï¼Œå¦‚æœSREå›¢é˜Ÿå¿™äºä¸ºæ‰‹å·¥æ“ä½œå’Œå¯¼å‡ºæ•°æ®æ•‘ç«ï¼Œæ–°åŠŸèƒ½çš„å‘å¸ƒå°±ä¼šå˜æ…¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼€åˆ›å…ˆä¾‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœSREè¿‡äºæ„¿æ„æ‰¿æ‹…çäº‹ï¼Œç ”å‘åŒäº‹å°±æ›´å€¾å‘äºåŠ å…¥æ›´å¤šçš„çäº‹ï¼Œæœ‰æ—¶å€™ç”šè‡³å°†æœ¬è¯¥ç”±ç ”å‘å›¢é˜Ÿæ‰¿æ‹…çš„è¿ç»´å·¥ä½œè½¬ç»™SREæ¥æ‰¿æ‹…ã€‚å…¶ä»–å›¢é˜Ÿä¹Ÿä¼šå¼€å§‹æŒ‡æœ›SREæ¥å—è¿™æ ·çš„å·¥ä½œï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¥½çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¿ƒè¿›æ‘©æ“¦äº§ç”Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å³ä½¿ä½ ä¸ªäººå¯¹çäº‹æ²¡æœ‰æ€¨è¨€ï¼Œä½ ç°åœ¨çš„æˆ–æœªæ¥çš„é˜Ÿå‹å¯èƒ½ä¼šå¾ˆä¸å¼€å¿ƒã€‚å¦‚æœå›¢é˜Ÿä¸­å¼•å…¥äº†å¤ªå¤šçš„çäº‹ï¼Œå…¶å®å°±æ˜¯åœ¨é¼“åŠ±å›¢é˜Ÿé‡Œæœ€å¥½çš„å·¥ç¨‹å¸ˆå¼€å§‹å¯»æ‰¾å…¶ä»–åœ°æ–¹æä¾›çš„æ›´æœ‰ä»·å€¼çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿åæ‰¿è¯º&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‚£äº›ä¸ºäº†é¡¹ç›®å·¥ç¨‹å·¥ä½œè€Œå…¥èŒçš„æ–°å‘˜å·¥ï¼Œä»¥åŠè½¬å…¥SREçš„è€å‘˜å·¥ä¼šæœ‰è¢«æ¬ºéª—çš„æ„Ÿè§‰ï¼Œè¿™éå¸¸ä¸åˆ©äºå…¬å¸çš„å£«æ°”ã€‚&lt;/p&gt;
&lt;p&gt;Â &lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬éƒ½è‡´åŠ›äºæ¯ä¸€å‘¨é€šè¿‡å·¥ç¨‹å·¥ä½œæ¶ˆé™¤ä¸€ç‚¹çäº‹ï¼Œå°±å¯ä»¥æŒç»­æ€§åœ°æ•´é¡¿æœåŠ¡ã€‚æˆ‘ä»¬å°±å¯ä»¥å°†æ›´å¤šçš„åŠ›é‡æŠ•å…¥åˆ°æ‰©å¤§æœåŠ¡è§„æ¨¡çš„å·¥ç¨‹å·¥ä½œä¸Šå»ï¼Œæˆ–è€…æ˜¯è¿›è¡Œä¸‹ä¸€ä»£çš„æœåŠ¡çš„æ¶æ„è®¾è®¡ï¼Œåˆæˆ–è€…æ˜¯å»ºç«‹ä¸€å¥—è·¨SREä½¿ç”¨çš„å·¥å…·é“¾ã€‚è®©æˆ‘ä»¬å¤šåˆ›æ–°ï¼Œå°‘å¹²çäº‹å§ï¼&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å†å²è¯„è®º-1-æ¡"&gt;å†å²è¯„è®º (1 æ¡)
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ä»¥ä¸‹è¯„è®ºæ¥è‡ªåŸ WordPress ç«™ç‚¹ï¼Œä»…ä½œå­˜æ¡£å±•ç¤ºã€‚&lt;/em&gt;&lt;/p&gt;

 &lt;blockquote&gt;
 &lt;p&gt;&lt;strong&gt;wallsis&lt;/strong&gt; (2020-03-12 11:40)&lt;/p&gt;
&lt;p&gt;å¤§ç¥ï¼Œæ„Ÿè§‰æ‚¨å¥½ä¹…éƒ½æ²¡æ›´æ–°æ–‡ç« äº†ï¼Œå¸Œæœ›èƒ½çœ‹åˆ°æ‚¨æ›´å¤šçš„æŠ€æœ¯åˆ†äº«ï¼ŒğŸ˜†&lt;/p&gt;

 &lt;/blockquote&gt;</description></item><item><title>é…ç½®å’Œä½¿ç”¨kube-prometheus</title><link>https://www.calmkart.com/posts/2019/08/2019-08-22-%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8kube-prometheus/</link><pubDate>Thu, 22 Aug 2019 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2019/08/2019-08-22-%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8kube-prometheus/</guid><description>&lt;p&gt;æˆ‘ä»¬åœ¨k8sé›†ç¾¤ä¸­ä½¿ç”¨äº‘åŸç”Ÿçš„promethuesé€šå¸¸éœ€è¦ç”¨åˆ°coreosçš„&lt;a class="link" href="https://github.com/coreos/prometheus-operator" target="_blank" rel="noopener"
 &gt;prometheus-operater&lt;/a&gt;ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬åœ¨k8sä¸­éƒ¨ç½²å’Œé…ç½®ä½¿ç”¨prometheusã€‚ä½†prometheuså¹¶ä¸æ˜¯å¼€ç®±å³ç”¨çš„ï¼Œå¦‚æœè¦åšåˆ°å¼€ç®±å³ç”¨çš„ç›‘æ§å…¨å®¶æ¡¶ï¼Œå®˜æ–¹æä¾›äº†ä¸¤ä¸ªé€‰æ‹©ï¼Œåˆ†åˆ«æ˜¯&lt;a class="link" href="https://github.com/helm/charts/tree/master/stable/prometheus-operator" target="_blank" rel="noopener"
 &gt;prometheus-operater helm chart&lt;/a&gt;å’Œ&lt;a class="link" href="https://github.com/coreos/kube-prometheus" target="_blank" rel="noopener"
 &gt;kube-prometheus&lt;/a&gt;ã€‚è¿™ä¸¤è€…éƒ½å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›å¼€ç®±å³ç”¨çš„æ–¹å¼éƒ¨ç½²promethues+alertmanager+promethues-push-gateway(kube-promethueusä¸åŒ…å«,éœ€è¦å•ç‹¬éƒ¨ç½²)+grafanaå…¨å®¶æ¡¶ï¼ŒåŒæ—¶åŒ…å«&lt;a class="link" href="https://github.com/kubernetes-monitoring/kubernetes-mixin" target="_blank" rel="noopener"
 &gt;kubernetes-mixin&lt;/a&gt;çš„ä¸€æ•´å¥—æŠ¥è­¦è§„åˆ™å’Œnode-exporterï¼Œkube-state-metricsç­‰ä¸€ç³»åˆ—metrics exporterã€‚åŒºåˆ«åœ¨äºhelm chartç”±ç¤¾åŒºç»´æŠ¤ï¼Œè€Œkube-promethuesç”±coreosç»´æŠ¤ã€‚è¿™é‡Œæˆ‘ä»¬å°†ä»¥kube-prometheusä¸ºä¾‹ï¼Œç®€è¦è¯´æ˜é…ç½®å’Œä½¿ç”¨æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯éƒ¨ç½²ï¼Œè¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œæˆ‘ä»¬å…ˆå°†kube-prometheusçš„ä»“åº“cloneä¸‹æ¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;git clone https://github.com/coreos/kube-prometheus.git
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæ ¹æ®å®˜æ–¹æ–‡æ¡£æ“ä½œå³å¯&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$ kubectl create -f manifests/

# It can take a few seconds for the above &amp;#39;create manifests&amp;#39; command to fully create the following resources, so verify the resources are ready before proceeding.
$ until kubectl get customresourcedefinitions servicemonitors.monitoring.coreos.com ; do date; sleep 1; echo &amp;#34;&amp;#34;; done
$ until kubectl get servicemonitors --all-namespaces ; do date; sleep 1; echo &amp;#34;&amp;#34;; done

$ kubectl apply -f manifests/ # This command sometimes may need to be done twice (to workaround a race condition).
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œå°†è‡ªåŠ¨ä¸ºæˆ‘ä»¬éƒ¨ç½²prometheusï¼Œalertmanagerå’Œgrafanaã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡port-forwardä¹Ÿå¯ä»¥é€šè¿‡ingresså°†æœåŠ¡æš´éœ²å‡ºæ¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Prometheus

$ kubectl --namespace monitoring port-forward svc/prometheus-k8s 9090

Then access via http://localhost:9090

Grafana

$ kubectl --namespace monitoring port-forward svc/grafana 3000

Then access via http://localhost:3000 and use the default grafana user:password of admin:admin.

Alert Manager

$ kubectl --namespace monitoring port-forward svc/alertmanager-main 9093

Then access via http://localhost:9093
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…ç¼–å†™ingress&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# ingress-monitor.yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
 name: monitoring-ingress
 annotations:
 nginx.ingress.kubernetes.io/ssl-redirect: &amp;#34;false&amp;#34;
 namespace: monitoring
spec:
 rules:
 - host: k8s-prometheus.calmkart.com
 http:
 paths:
 - path: /
 backend:
 serviceName: prometheus-k8s
 servicePort: 9090
 - host: k8s-grafana.calmkart.com
 http:
 paths:
 - path: /
 backend:
 serviceName: grafana
 servicePort: 3000
 - host: k8s-alertmanager.calmkart.com
 http:
 paths:
 - path: /
 backend:
 serviceName: alertmanager-main
 servicePort: 9093

# kubectl apply -f ingress-monitor.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¿é—®åˆ°prometheus,alertmanagerå’Œgrafanaçš„æœåŠ¡é¡µé¢äº† &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2019/08/prometheus.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/prometheus.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2019/08/alert-manager.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/alert-manager.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2019/08/grafana.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/grafana.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œprometheuså·²ç»é›†æˆäº†ä¸€äº›k8sç›¸å…³çš„exporterå’Œkubernetes-mixinçš„æŠ¥è­¦è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥ä»prometheusçš„status-&amp;gt;ruleså’Œstatus-&amp;gt;targetä¸­æŸ¥çœ‹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éƒ¨ç½²&lt;a class="link" href="https://github.com/helm/charts/tree/master/stable/prometheus-pushgateway" target="_blank" rel="noopener"
 &gt;push-gateway&lt;/a&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#å¯ä»¥å‚è€ƒæˆ‘è¿™é‡ŒNodePortçš„valueså‚æ•°,ä¹Ÿå¯ä»¥è‡ªè¡Œè®¾ç½®
# values.yaml

# Default values for prometheus-pushgateway.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
image:
 repository: prom/pushgateway
 tag: v0.9.0
 pullPolicy: IfNotPresent

service:
 type: NodePort
 port: 9091
 targetPort: 9091

# Optional pod annotations
podAnnotations: {}

# Optional pod labels
podLabels: {}

# Optional service labels
serviceLabels: {}

# Optional serviceAccount labels
serviceAccountLabels: {}

# Optional additional arguments
extraArgs: []

# Optional additional environment variables
extraVars: []

resources: {}
 # We usually recommend not to specify default resources and to leave this as a conscious
 # choice for the user. This also increases chances charts run on environments with little
 # resources, such as Minikube. If you do want to specify resources, uncomment the following
 # lines, adjust them as necessary, and remove the curly braces after &amp;#39;resources:&amp;#39;.
 # limits:
 # cpu: 200m
 # memory: 50Mi
 # requests:
 # cpu: 100m
 # memory: 30Mi

serviceAccount:
 # Specifies whether a ServiceAccount should be created
 create: true
 # The name of the ServiceAccount to use.
 # If not set and create is true, a name is generated using the fullname template
 name:

## Configure ingress resource that allow you to access the
## pushgateway installation. Set up the URL
## ref: http://kubernetes.io/docs/user-guide/ingress/
##
ingress:
 ## Enable Ingress.
 ##
 enabled: false

 ## Annotations.
 ##
 # annotations:
 # kubernetes.io/ingress.class: nginx
 # kubernetes.io/tls-acme: &amp;#39;true&amp;#39;

 ## Hostnames.
 ## Must be provided if Ingress is enabled.
 ##
 # hosts:
 # - pushgateway.domain.com

 ## TLS configuration.
 ## Secrets must be manually created in the namespace.
 ##
 # tls:
 # - secretName: pushgateway-tls
 # hosts:
 # - pushgateway.domain.com

tolerations: {}
 # - effect: NoSchedule
 # operator: Exists

## Node labels for pushgateway pod assignment
## Ref: https://kubernetes.io/docs/user-guide/node-selection/
##
nodeSelector: {}

replicaCount: 1

## Affinity for pod assignment
## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
affinity: {}

# Enable this if you&amp;#39;re using https://github.com/coreos/prometheus-operator
serviceMonitor:
 enabled: true
 namespace: monitoring
 # fallback to the prometheus default unless specified
 # interval: 10s
 ## Defaults to what&amp;#39;s used if you follow CoreOS [Prometheus Install Instructions](https://github.com/helm/charts/tree/master/stable/prometheus-operator#tldr)
 ## [Prometheus Selector Label](https://github.com/helm/charts/tree/master/stable/prometheus-operator#prometheus-operator-1)
 ## [Kube Prometheus Selector Label](https://github.com/helm/charts/tree/master/stable/prometheus-operator#exporters)
 selector:
 prometheus: kube-prometheus
 # Retain the job and instance labels of the metrics pushed to the Pushgateway
 # [Scraping Pushgateway](https://github.com/prometheus/pushgateway#configure-the-pushgateway-as-a-target-to-scrape)
 honorLabels: true

# The values to set in the PodDisruptionBudget spec (minAvailable/maxUnavailable)
# If not set then a PodDisruptionBudget will not be created
podDisruptionBudget:

# helm install --name push-gateway -f values.yaml stable/prometheus-pushgateway
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬æ¥è¯•ç€æ¥å…¥å†…éƒ¨å’Œå¤–éƒ¨çš„prometheusç›‘æ§target.&lt;/p&gt;
&lt;p&gt;1.å®ç°æ¥å…¥å†…éƒ¨çš„target æ— è®ºæ˜¯å¤–éƒ¨æˆ–å†…éƒ¨çš„targetéƒ½éœ€è¦ä¸€ä¸ªmetrics-serverç›®æ ‡ï¼Œå¯¹äºå†…éƒ¨targetè€Œè¨€ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚æœåŠ¡calm-server åœ¨prometheus-operaterçš„ä½¿ç”¨æ–¹å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªcrdå«serviceMonitorï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„serviceMonitorå°±åˆ›å»ºäº†ä¸€ä¸ªprometheusçš„target æˆ‘ä»¬é¦–å…ˆæŸ¥çœ‹monitoringå‘½åç©ºé—´ä¸­å·²æœ‰çš„serviceMonitor(æ—¢prometheus target)&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[xxx@xxxxx]# kubectl get servicemonitors.monitoring.coreos.com -n monitoring
NAME AGE
alertmanager 23d
coredns 23d
grafana 23d
ingress-nginx 17d
kube-apiserver 23d
kube-controller-manager 23d
kube-scheduler 23d
kube-state-metrics 23d
kubelet 23d
node-exporter 23d
prometheus 23d
prometheus-operator 23d
prometheus-pushgateway 19d
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„serviceMonitor,å°†calm-serverçš„/metricsä½œä¸ºtarget # calm-server-serviceMonitor.yaml&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
 name: calm-server-metrics
 labels:
 k8s-app: calm-server-metrics
 namespace: monitoring
spec:
 namespaceSelector:
 any: true
 selector:
 matchLabels:
 app: calm-server
 endpoints:
 - port: web
 interval: 10s
 honorLabels: true

# kubectl apply -f calm-server-serviceMonitor.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„tips:&lt;/p&gt;
&lt;p&gt;1.å¦‚æœserviceå’Œprometheusä¸å†åŒä¸€ä¸ªå‘½åç©ºé—´ï¼Œéœ€è¦è®¾ç½®namespaceSelectorï¼Œå¯ä»¥å•ç‹¬è®¾ç½®éœ€è¦æœç´¢çš„namespaceï¼Œä¹Ÿå¯ä»¥åƒä¸Šé¢é‚£æ ·è®¾ç½®ä¸ºå…¨å±€æœç´¢ã€‚&lt;/p&gt;
&lt;p&gt;2.å…¶æ¬¡ï¼Œendpointsä¸­è®¾ç½®çš„portä¼šæŒ‰ç…§intervalè®¾ç½®çš„æ—¶é—´å®šæ—¶å»:/metricsæ‹‰å–æ•°æ®ï¼Œæ‰€ä»¥å¯¹åº”çš„æœåŠ¡éœ€è¦æä¾›ç›¸åº”çš„metrics(å®˜æ–¹æœ‰éå¸¸å¤šçš„exporteræä¾›ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ&lt;a class="link" href="https://prometheus.io/docs/instrumenting/exporters/" target="_blank" rel="noopener"
 &gt;https://prometheus.io/docs/instrumenting/exporters/&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥ä¸‹æ¥å†æŸ¥çœ‹æ‰€æœ‰serviceMonitor crd apiå¯¹è±¡ï¼Œå°±ä¼šå‘ç°åˆ›å»ºæˆåŠŸï¼ŒåŒæ—¶prometheusçš„state-&amp;gt;targetä¸­ä¹Ÿä¼šå‡ºç°å¯¹åº”çš„targetï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨prometheusä¸­æŸ¥è¯¢åˆ°å¯¹åº”çš„æ•°æ®äº†ã€‚&lt;/p&gt;
&lt;p&gt;2.å®ç°æ¥å…¥å¤–éƒ¨target å®ç°äº†æ¥å…¥å†…éƒ¨çš„targetï¼Œé‚£ä¹ˆï¼Œk8sé›†ç¾¤å¤–éƒ¨çš„æœåŠ¡æƒ³è¦æ¥å…¥è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå½“ç„¶è¿˜æ˜¯é€šè¿‡ç›‘æ§k8sé›†ç¾¤å†…serviceçš„æ–¹å¼ï¼Œä¸æ˜¯serviceå¯¹åº”çš„æ˜¯ä¸€ä¸ªå¤–éƒ¨çš„endpointå¯¹è±¡ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä»¥calm-serveræœåŠ¡ä¸ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•é€šè¿‡k8sçš„endpointå¤–éƒ¨å¯¹è±¡æ¥å…¥å¤–éƒ¨targetç›‘æ§ã€‚ é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªendpointå¯¹è±¡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# calm-server-endpoint.yaml
apiVersion: v1
kind: Endpoints
metadata:
 name: calm-server-metrics
subsets:
 - addresses:
 - ip: x.x.x.x
 ports:
 - name: metrics
 port: xxxx
 protocol: TCP
# kubectl apply -f calm-server-endpoint.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å°†ipå’Œportæ›¿æ¢æˆæˆ‘ä»¬çš„å¤–éƒ¨æœåŠ¡ï¼Œapplyåå°±åˆ›å»ºäº†ä¸€ä¸ªendpoint apiå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡kubectl get endpointsæŸ¥çœ‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[xxx@xxxxxxx]# kubectl get endpoints
NAME ENDPOINTS AGE
calm-server-metrics 10.41.13.17:6789 19d
kubernetes 10.1.33.159:6443 92d
push-gateway-prometheus-pushgateway 10.240.224.15:9091 19d
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯,endpointå¯¹è±¡æ˜¯ä¸åŒºåˆ†namespacesçš„ æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªserviceï¼Œserviceçš„é€‰æ‹©å™¨é€‰æ‹©calm-server-metricsè¿™ä¸ªå¤–éƒ¨endpoint&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# calm-server-metrics-service.yaml

apiVersion: v1
kind: Service
metadata:
 name: calm-server-metrics
 labels:
 app: calm-server-metrics
spec:
 type: ExternalName
 externalName: x.x.x.x
 clusterIP: &amp;#34;&amp;#34;
 ports:
 - name: metrics
 port: xxxx
 protocol: TCP
 targetPort: 6789

# kubectl apply -f calm-server-metrics-service.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬è¿™ä¸ªæ—¶å€™è®¿é—®è¿™ä¸ªæœåŠ¡ï¼Œå°±ç­‰äºè®¿é—®äº†å¤–éƒ¨çš„endpointï¼Œæ—¢å¤–éƒ¨æœåŠ¡ æˆ‘ä»¬å°±å¯ä»¥åƒä¸Šé¢åˆ›å»ºå†…éƒ¨æœåŠ¡çš„serviceMonitorä¸€æ ·ï¼Œåˆ›å»ºserviceMonitor apiå¯¹è±¡ä»è€Œæ›´æ–°prometheus targetåˆ—è¡¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ä¿®æ”¹è¿™ä¸€ç³»åˆ—å…¨å®¶æ¡¶çš„é…ç½®å‘¢?æ¯”å¦‚prometheusçš„é…ç½®ï¼Œgrafanaçš„é…ç½®ã€‚æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹smtpæŠ¥è­¦é…ç½®è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¦‚æœæ˜¯éäº‘åŸç”Ÿç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ï¼Œä½†åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­ä¸ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;kube-prometheuså®˜æ–¹æ–‡æ¡£æ¨èçš„æ–¹å¼æ˜¯ä½¿ç”¨&lt;a class="link" href="https://jsonnet.org/" target="_blank" rel="noopener"
 &gt;jsonnet&lt;/a&gt;å¯¹å®˜æ–¹åº“åšç¼–è¯‘ä¿®æ”¹ã€‚é‚£ä¹ˆå¦‚ä½•ç›´æ¥é€šè¿‡ä¿®æ”¹yamlçš„æ–¹å¼ä¿®æ”¹é…ç½®æ–‡ä»¶å‘¢ï¼Ÿä¸‹é¢å°†åˆ†åˆ«ä»‹ç»å¦‚ä½•ä¿®æ”¹å…¨å®¶æ¡¶ä¸­çš„å„ä¸ªé…ç½®æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;1.é¦–å…ˆæ˜¯prometheusçš„alert rulesï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹prometheus-rules.yamlæ–‡ä»¶ä¿®æ”¹ã€‚ 2.å…¶æ¬¡æ˜¯alertmanagerçš„config,æˆ‘ä»¬å¯ä»¥ä¿®æ”¹alertmanager-secret.yamlæ–‡ä»¶,æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªsecretå¯¹è±¡ï¼Œå†…å®¹ç»è¿‡äº†base64åŠ å¯†ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆå°†å†…å®¹è§£å¯†å†åšä¿®æ”¹ï¼Œä¿®æ”¹åå†åŠ å¯†æ›¿æ¢å³å¯ã€‚ 3.æœ€åæ˜¯grafanaçš„é…ç½®ä¿®æ”¹ï¼Œå‚è€ƒäº†grafanaå®˜æ–¹çš„docker imageä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¿®æ”¹grafana-deployment.yamlæ–‡ä»¶ï¼Œä¸ºå…¶å¢åŠ ä¸€ä¸ªvolume,é…ç½®å¦‚ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apiVersion: apps/v1beta2
kind: Deployment
metadata:
 labels:
 app: grafana
 name: grafana
 namespace: monitoring
spec:
 replicas: 1
 selector:
 matchLabels:
 app: grafana
 template:
 metadata:
 labels:
 app: grafana
 spec:
 containers:
 - image: grafana/grafana:6.2.2
 name: grafana
 ports:
 - containerPort: 3000
 name: http
 readinessProbe:
 httpGet:
 path: /api/health
 port: http
 resources:
 limits:
 cpu: 200m
 memory: 200Mi
 requests:
 cpu: 100m
 memory: 100Mi
 volumeMounts:
 - mountPath: /var/lib/grafana
 name: grafana-storage
 readOnly: false
 - mountPath: /etc/grafana/provisioning/datasources
 name: grafana-datasources
 readOnly: false
 - mountPath: /etc/grafana/provisioning/dashboards
 name: grafana-dashboards
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/apiserver
 name: grafana-dashboard-apiserver
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/controller-manager
 name: grafana-dashboard-controller-manager
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-cluster-rsrc-use
 name: grafana-dashboard-k8s-cluster-rsrc-use
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-node-rsrc-use
 name: grafana-dashboard-k8s-node-rsrc-use
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-resources-cluster
 name: grafana-dashboard-k8s-resources-cluster
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-resources-namespace
 name: grafana-dashboard-k8s-resources-namespace
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-resources-pod
 name: grafana-dashboard-k8s-resources-pod
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-resources-workload
 name: grafana-dashboard-k8s-resources-workload
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/k8s-resources-workloads-namespace
 name: grafana-dashboard-k8s-resources-workloads-namespace
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/kubelet
 name: grafana-dashboard-kubelet
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/nodes
 name: grafana-dashboard-nodes
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/persistentvolumesusage
 name: grafana-dashboard-persistentvolumesusage
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/pods
 name: grafana-dashboard-pods
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/prometheus-remote-write
 name: grafana-dashboard-prometheus-remote-write
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/prometheus
 name: grafana-dashboard-prometheus
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/proxy
 name: grafana-dashboard-proxy
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/scheduler
 name: grafana-dashboard-scheduler
 readOnly: false
 - mountPath: /grafana-dashboard-definitions/0/statefulset
 name: grafana-dashboard-statefulset
 readOnly: false
 - mountPath: /etc/grafana
 name: config-custom
 nodeSelector:
 beta.kubernetes.io/os: linux
 securityContext:
 runAsNonRoot: true
 runAsUser: 65534
 serviceAccountName: grafana
 volumes:
 - emptyDir: {}
 name: grafana-storage
 - name: grafana-datasources
 secret:
 secretName: grafana-datasources
 - configMap:
 name: grafana-dashboards
 name: grafana-dashboards
 - configMap:
 name: grafana-dashboard-apiserver
 name: grafana-dashboard-apiserver
 - configMap:
 name: grafana-dashboard-controller-manager
 name: grafana-dashboard-controller-manager
 - configMap:
 name: grafana-dashboard-k8s-cluster-rsrc-use
 name: grafana-dashboard-k8s-cluster-rsrc-use
 - configMap:
 name: grafana-dashboard-k8s-node-rsrc-use
 name: grafana-dashboard-k8s-node-rsrc-use
 - configMap:
 name: grafana-dashboard-k8s-resources-cluster
 name: grafana-dashboard-k8s-resources-cluster
 - configMap:
 name: grafana-dashboard-k8s-resources-namespace
 name: grafana-dashboard-k8s-resources-namespace
 - configMap:
 name: grafana-dashboard-k8s-resources-pod
 name: grafana-dashboard-k8s-resources-pod
 - configMap:
 name: grafana-dashboard-k8s-resources-workload
 name: grafana-dashboard-k8s-resources-workload
 - configMap:
 name: grafana-dashboard-k8s-resources-workloads-namespace
 name: grafana-dashboard-k8s-resources-workloads-namespace
 - configMap:
 name: grafana-dashboard-kubelet
 name: grafana-dashboard-kubelet
 - configMap:
 name: grafana-dashboard-nodes
 name: grafana-dashboard-nodes
 - configMap:
 name: grafana-dashboard-persistentvolumesusage
 name: grafana-dashboard-persistentvolumesusage
 - configMap:
 name: grafana-dashboard-pods
 name: grafana-dashboard-pods
 - configMap:
 name: grafana-dashboard-prometheus-remote-write
 name: grafana-dashboard-prometheus-remote-write
 - configMap:
 name: grafana-dashboard-prometheus
 name: grafana-dashboard-prometheus
 - configMap:
 name: grafana-dashboard-proxy
 name: grafana-dashboard-proxy
 - configMap:
 name: grafana-dashboard-scheduler
 name: grafana-dashboard-scheduler
 - configMap:
 name: grafana-dashboard-statefulset
 name: grafana-dashboard-statefulset
 - configMap:
 name: grafana-config
 name: config-custom
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…¶å®å°±æ˜¯å°†ä¸€ä¸ªå«grafana-configçš„configMapä½œä¸ºvolumeMountåˆ°/etc/grafanaä¸‹ã€‚ ç„¶åæˆ‘ä»¬åˆ›å»ºè¿™ä¸ªconfigMap&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# grafana-configmap.yaml

apiVersion: v1
kind: ConfigMap
metadata:
 name: grafana-config
 namespace: monitoring
data:
 grafana.ini: |
 [smtp]
 enabled = true
 host = smtp.calmkart.com:465
 user = calmkart@calmkart.com
 password = xxxxxxxxxx
 skip_verify = false
 from_address = calmkart@calmkart.com
 from_name = grafana

# kubectl apply -f grafana-configmap.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ ·å°±å¯ä»¥æ›¿æ¢æ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿˜æœ‰å…³äºå¦‚ä½•ä¸ºgrafanaå¢åŠ pluginç­‰ç­‰è¯é¢˜ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹çš„ç›¸å…³èµ„æ–™ã€‚ å°±ç®€å•ä»‹ç»åˆ°è¿™é‡Œå§ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å†å²è¯„è®º-1-æ¡"&gt;å†å²è¯„è®º (1 æ¡)
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ä»¥ä¸‹è¯„è®ºæ¥è‡ªåŸ WordPress ç«™ç‚¹ï¼Œä»…ä½œå­˜æ¡£å±•ç¤ºã€‚&lt;/em&gt;&lt;/p&gt;

 &lt;blockquote&gt;
 &lt;p&gt;&lt;strong&gt;æ›°..æ›°&lt;/strong&gt; (2019-08-26 19:35)&lt;/p&gt;
&lt;p&gt;ç‰›é€¼çš„å½­è‘£ï¼Œç¢¾å‹æˆ‘ç­‰åº•å±‚åŠ³è‹¦å¤§ä¼—ï¼Œæˆ‘æ˜¯æœçš„&lt;/p&gt;

 &lt;/blockquote&gt;</description></item><item><title>yumæºåˆ›å»ºå’Œæ›´æ–°è‡ªå·±çš„åŒ…</title><link>https://www.calmkart.com/posts/2018/07/2018-07-23-yum%E6%BA%90%E5%88%9B%E5%BB%BA%E5%92%8C%E6%9B%B4%E6%96%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8C%85/</link><pubDate>Mon, 23 Jul 2018 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2018/07/2018-07-23-yum%E6%BA%90%E5%88%9B%E5%BB%BA%E5%92%8C%E6%9B%B4%E6%96%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8C%85/</guid><description>&lt;p&gt;ä»¥tengineä¸ºä¾‹ï¼Œè®°å½•æ·»åŠ yumè‡ªç”¨æ‰“åŒ…è¿‡ç¨‹.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ,ä¸‹è½½tengine&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;wget https://github.com/alibaba/tengine/archive/tengine-2.2.2.tar.gz
tar xzvf tengine-2.2.2.tar.gz
cd tengine-tengine-2.2.2/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åå®‰è£…æ‰“åŒ…å·¥å…·fpm&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;yum -y install ruby rubygems ruby-devel rpm-build
gem sources -a http://ruby.taobao.org/
gem install fpm
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¼–è¯‘å®‰è£…åˆ°å…¶ä»–æ–‡ä»¶å¤¹ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;./configure --prefix=/home/maintain/nginx --conf-path=/home/shared/nginx/conf/nginx.conf --pid-path=/home/shared/nginx/logs/nginx.pid --error-log-path=/home/shared/nginx/logs/error.log --with-http_ssl_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_gzip_static_module --with-http_stub_status_module --with-http_v2_module --with-http_realip_module --add-module=ngx_cache_purge-2.3
make
mkdir /tmp/installdir
make install DESTDIR=/tmp/installdir/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰“åŒ…æˆrpmåŒ…&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;cd /tmp/installdir/
fpm -s dir -t rpm -n tengine -v 2.2.0 --iteration 1.el6 -C /tmp/installdir/ -p /root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰“å‡ºæ¥çš„åŒ…ä¼šåœ¨/rootæ–‡ä»¶å¤¹ä¸‹&lt;/p&gt;
&lt;p&gt;ç„¶åå°†rpmå®‰è£…åŒ…ä¸Šä¼ åˆ°è‡ªå»ºyumä»“åº“,åˆ·æ–°ä»“åº“&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;createrepo --update {{ path }}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®¢æˆ·ç«¯åˆ·æ–°centos yumç¼“å­˜å³å¯&lt;/p&gt;</description></item><item><title>éƒ¨ç½²sentryæ•è·é¡¹ç›®é”™è¯¯ä¿¡æ¯</title><link>https://www.calmkart.com/posts/2018/01/2018-01-25-%E9%83%A8%E7%BD%B2sentry%E6%8D%95%E8%8E%B7%E9%A1%B9%E7%9B%AE%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF/</link><pubDate>Thu, 25 Jan 2018 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2018/01/2018-01-25-%E9%83%A8%E7%BD%B2sentry%E6%8D%95%E8%8E%B7%E9%A1%B9%E7%9B%AE%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF/</guid><description>&lt;p&gt;sentryæ˜¯ä¸€æ¬¾ä¸“ç”¨äºæ•æ‰é¡¹ç›®é”™è¯¯ä¿¡æ¯çš„åˆ†å¸ƒå¼å¼€æºè½¯ä»¶ï¼Œå¯ä»¥è½»æ¾çš„æ•æ‰åˆ°ä¸åŒé¡¹ç›®çš„é”™è¯¯ä¿¡æ¯å¹¶æ±‡æ€»ï¼Œæ–¹ä¾¿å®æ—¶æŸ¥çœ‹ä¸Šä¸‹æ–‡æ’é”™ä»¥åŠæŠ¥è­¦ç­‰ã€‚ æœ€ç»ˆæ•ˆæœå›¾å¦‚ä¸‹ï¼š &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/sentry1.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/sentry1.jpg" alt="" /&gt;
&lt;/a&gt; &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/sentry2.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/sentry2.jpg" alt="" /&gt;
&lt;/a&gt; &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/sentry3.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/sentry3.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œsentryå’ŒELKçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œè™½ç„¶éƒ½åŸºäºLOGçš„è¿½è¸ªï¼Œä½†sentryä¸»è¦å…³æ³¨é”™è¯¯çš„æ•è·å’Œä¸Šä¸‹æ–‡é‡å‡ºç°æŠ¥è­¦ï¼Œè€ŒELKä¸»è¦å…³æ³¨æ—¥å¿—çš„å¤„ç†ã€‚&lt;/p&gt;
&lt;h4 id="1sentryçš„éƒ¨ç½²"&gt;1.sentryçš„éƒ¨ç½²
&lt;/h4&gt;&lt;p&gt;å®˜æ–¹æ–‡æ¡£ &lt;a class="link" href="https://docs.sentry.io/" target="_blank" rel="noopener"
 &gt;https://docs.sentry.io/&lt;/a&gt; å¤§è‡´æ¥è¯´ï¼Œä¸»è¦åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#å®‰è£…postgresql
apt-get install postgresql
apt-get install postgresql-contrib

#å®‰è£…celeryï¼Œredis
pip install celery
apt-get install redis-server

#å®‰è£…éœ€è¦çš„åŒ…
apt-get install python-setuptools python-dev libxslt1-dev gcc libffi-dev libjpeg-dev libxml2-dev libxslt-dev libyaml-dev libpq-dev

#å®‰è£…sentryï¼Œæ¨èä½¿ç”¨venvç¯å¢ƒ
pip install sentry

#ç”Ÿæˆé…ç½®æ–‡ä»¶,ä¹Ÿå¯åˆ¶å®šé…ç½®æ–‡ä»¶è·¯å¾„
#sentryÂ initÂ /etc/sentry 
sentry init

#é…ç½®æ•°æ®åº“
sudo -u postgres psql
create user admin with password &amp;#39;admin&amp;#39;;
create database sentry owner admin;
grant all privileges on database sentry to admin;

#æå‡è¯¥ç”¨æˆ·superuseræƒé™
alterÂ role admin superuser;

#ä¿®æ”¹sentryçš„ç›¸å…³é…ç½®ï¼Œé…ç½®æ•°æ®åº“ç›¸å…³è®¾ç½®ï¼Œä¸ä¸Šæ•°æ®åº“è®¾ç½®ç›¸ç¬¦åˆ
vi /root/.sentry/sentry.conf.py

#åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¯ä»¥åˆ¶å®šé…ç½®æ–‡ä»¶è·¯å¾„ä¹Ÿå¯é»˜è®¤
#SENTRY_CONF=/etc/sentryÂ sentryÂ upgrade
sentry upgrade

#æ·»åŠ celeryç”¨rootç”¨æˆ·è·‘çš„ç¯å¢ƒå˜é‡
export C_FORCE_ROOT=&amp;#34;true&amp;#34;

#æœ€ååˆ›å»ºç”¨æˆ·
sentry createuser
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨upgradeè¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œæ ¹æ®å…·ä½“é”™è¯¯ç±»å‹åˆ¤æ–­å¦‚ä½•æ’é”™ï¼Œç„¶ååˆ æ‰æ•°æ®åº“åé‡å»ºæ•°æ®åº“ï¼Œå†upgradeå³å¯ï¼Œä¸€èˆ¬éƒ½æ˜¯æ•°æ®åº“æƒé™é—®é¢˜ã€‚&lt;/p&gt;
&lt;h4 id="2sentryçš„ä½¿ç”¨"&gt;2.sentryçš„ä½¿ç”¨
&lt;/h4&gt;&lt;p&gt;ä¸»è¦è¦è·‘3ä¸ªä»»åŠ¡ï¼Œå¦‚ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#SENTRY_CONF=/etc/sentry sentry run web
sentry run web
#SENTRY_CONF=/etc/sentry sentry run worker
sentry run worker
#SENTRY_CONF=/etc/sentry sentry run cron
sentry run cron
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘åœ¨æµ‹è¯•ç¯å¢ƒä¸­æ˜¯ç”¨gosuvæ¥è·‘çš„ï¼Œæ•ˆæœå¦‚å›¾ï¼š &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/gosuv.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/gosuv.jpg" alt="" /&gt;
&lt;/a&gt; å…¶ä¸­è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä»»åŠ¡ç›´æ¥ç”¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;sentry run web
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ ·æ¥è·‘çš„è¯ï¼Œä¼šæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦é…ç½®æˆå¦‚ä¸‹ç»“æ„ï¼š &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/gosuv2.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/gosuv2.jpg" alt="" /&gt;
&lt;/a&gt; åŒæ—¶ï¼Œè¿˜è·‘äº†ä¸€ä¸ªç”¨äºæµ‹è¯•ç›‘æ§æ•è·é”™è¯¯çš„flaskç¨‹åºï¼Œå…¶ä¸­ç”¨åˆ°äº†venvï¼Œæ‰€ä»¥gosuvä¹Ÿå¥½ï¼Œsupervisorä¹Ÿå¥½ï¼Œéƒ½éœ€è¦åšæˆå¦‚ä¸‹è®¾ç½®&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#æ‰¾åˆ°venvçš„è™šæ‹Ÿç¯å¢ƒï¼Œç”¨è™šæ‹Ÿç¯å¢ƒçš„binè¿è¡Œé¡¹ç›®
./venv/bin/python runserver.py
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="3sentry-webçš„åº”ç”¨å’Œé…ç½®"&gt;3.sentry webçš„åº”ç”¨å’Œé…ç½®
&lt;/h4&gt;&lt;p&gt;é»˜è®¤èµ·çš„sentry webå ç”¨çš„æ˜¯9000ç«¯å£ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ä¿®æ”¹ç«¯å£å·ã€‚ ç™»é™†ip:9000ï¼Œè¾“å…¥åˆšæ‰è®¾ç½®çš„é‚®ç®±è´¦å·å¯†ç è¿›å…¥sentryï¼Œå¡«ä¸€ä¸‹ç›¸å…³è®¾ç½® ç‚¹å‡»å³ä¸Šè§’new project,é€‰æ‹©ä½ éœ€è¦ç›‘æ§é”™è¯¯çš„å¯¹è±¡ï¼Œè¿™é‡Œé€‰æ‹©flaskï¼Œç„¶åä¼šå‡ºç° &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/sentry4.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/sentry4.jpg" alt="" /&gt;
&lt;/a&gt; ä¸»è¦å…³æ³¨è¿™ä¸ªDSN keyï¼Œåœ¨å·²æœ‰çš„é¡¹ç›®å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/sentry5.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/sentry5.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åé¦–å…ˆåœ¨å®¢æˆ·ç«¯å®‰è£…maven[flask]&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;pip install raven[flask]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æœ€ååœ¨flaskç¨‹åºé‡Œæ·»åŠ å¦‚ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#__init__.pyé‡Œè®¾ç½®appï¼Œæ•…æ·»åŠ å¦‚ä¸‹
from raven.contrib.flask import Sentry
sentry = Sentry(app, 
 dsn=&amp;#39;http://f1010071f12c47768dc6b5a4700d9c2e:5643252bcc70471eb5232a632f3ea133@10.32.80.118:9000//2&amp;#39;
 )

#views.pyé‡Œæ·»åŠ å¦‚ä¸‹
fromÂ flask_securityÂ importÂ login_required,Â current_user
fromÂ helloÂ importÂ app
fromÂ helloÂ importÂ sentry

@app.route(&amp;#39;/error&amp;#39;)
defÂ error():
 try:
 1/0
 exceptÂ ZeroDivisionError:
 sentry.captureException()
Â Â Â Â Â Â Â Â returnÂ &amp;#39;error&amp;#39;

@app.route(&amp;#39;/raise&amp;#39;)
defÂ auto_raise():
 raiseÂ IndexError

@app.route(&amp;#39;/log&amp;#39;)
defÂ log():
Â Â Â Â sentry.captureMessage(&amp;#39;hello,Â world!&amp;#39;)
Â Â Â Â returnÂ &amp;#39;logging&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç±»ä¼¼å¦‚å›¾ç»“æ„ï¼š &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/flask.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/flask.jpg" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åœ¨sentryä¸­å³æ—¶æ•æ‰åˆ°å¯¹åº”çš„é”™è¯¯å’Œloggingäº†&lt;/p&gt;</description></item><item><title>supervisoré›†ä¸­åŒ–ç®¡ç†webå·¥å…·cesi</title><link>https://www.calmkart.com/posts/2018/01/2018-01-11-supervisor%E9%9B%86%E4%B8%AD%E5%8C%96%E7%AE%A1%E7%90%86web%E5%B7%A5%E5%85%B7cesi/</link><pubDate>Thu, 11 Jan 2018 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2018/01/2018-01-11-supervisor%E9%9B%86%E4%B8%AD%E5%8C%96%E7%AE%A1%E7%90%86web%E5%B7%A5%E5%85%B7cesi/</guid><description>&lt;p&gt;linuxè¿›ç¨‹ç®¡ç†å™¨supervisoræ˜¯ä¼šç»å¸¸è¢«ç”¨åˆ°çš„ï¼Œä½†æœåŠ¡å™¨å¤šäº†ä¹‹åï¼Œæ¯ä¸ªæœåŠ¡å™¨çš„è¿›ç¨‹ä¹Ÿä¸æ–¹ä¾¿ç®¡ç†ã€‚åŒæ—¶ï¼Œsupervisorè‡ªå¸¦çš„webç•Œé¢æ¯”è¾ƒç®€é™‹ï¼Œæ‰€ä»¥å°è¯•äº†ä¸€ä¸‹å®˜ç½‘æ¨èçš„ä¸€äº›ç¬¬ä¸‰æ–¹å¼€æºè½¯ä»¶ï¼Œæ¨èä¸€ä¸‹è¿™ä¸ªcesiã€‚ æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š &lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/1.jpg" target="_blank" rel="noopener"
 &gt;&lt;img src="images/1.jpg" alt="" /&gt;
&lt;/a&gt; [&lt;img src="images/2.jpg" alt="" /&gt;
&lt;/p&gt;
&lt;p&gt;](&lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/01/2.jpg" target="_blank" rel="noopener"
 &gt;http://www.calmkart.com/wp-content/uploads/2018/01/2.jpg&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;1.é¦–å…ˆæ˜¯å…³äºsupervisor é€šè¿‡aptæˆ–pipå®‰è£…éƒ½å¯ä»¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get install supervisor
#pip install supervisor
echo_supervisord_conf &amp;gt; /etc/supervisor/supervisord.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…³äºsupervisoré…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[unix_http_server]
#è¿™é‡Œé…ç½®æ˜¯å¦ç”¨unix socketé€šä¿¡æ¥è®©supervisorä¸supervisorctlåšé€šä¿¡

[inet_http_server]
#è¿™é‡Œæ˜¯ç”¨çš„httpçš„æ–¹å¼åšé€šä¿¡

[supervisorctl]
#è¿™é‡Œé€‰æ‹©supervisorctlåˆ°åº•ç”¨ä»¥ä¸Šä¸¤ç§ä¸­çš„å“ªç§æ–¹å¼æ¥ä¸supervisoré€šä¿¡ï¼Œé€‰æ‹©ä¸€ç§å³å¯ï¼Œè®°å¾—å¡«å†™å¯†ç 

[program:pro_name]
stdout_logfile = {path}
redirect_stderr = true ;è®©stderrä¹Ÿå†™å…¥stdoutä¸­
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¸¸ç”¨æ“ä½œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;supervisorctl reload #é‡å¯åŠ è½½supervisoré…ç½®æ–‡ä»¶
supervisorctl update #åªå¢åŠ æ–°å¢çš„é…ç½®æ–‡ä»¶
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2.å…³äºcesi&lt;/p&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a class="link" href="https://github.com/Gamegos/cesi" target="_blank" rel="noopener"
 &gt;https://github.com/Gamegos/cesi&lt;/a&gt; å®‰è£…cesi&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get install sqlite3 python python-flask
git clone https://github.com/Gamegos/cesi
cd cesi
sqlite3 ./userinfo.db &amp;lt; userinfo.sql
cp cesi.conf /etc/cesi.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é…ç½®cesi.conf,æˆ‘çš„é…ç½®å¦‚ä¸‹ï¼Œä¸€çœ‹å°±æ‡‚äº†&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[node:118]
username = ***
password = ***
host = 127.0.0.1
port = 9001

[node:calmkart]
username = ***
password = ***
host = 45.76.71.69
port = 9001

[node:121]
username = ***
password = ***
host = *.*.*.121
port = 9001

[environment:my_env]
members = 118,calmkart,121

[cesi]
database = /root/cesi/userinfo.db
activity_log = /var/log/cesi.log
host = 0.0.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç”¨supervisorè¿è¡Œcesi,é…ç½®æ–‡ä»¶å¦‚ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[program:cesi]
directory = /root/cesi/cesi/
command = python web.py
autostart = true
startsecs = 5
autorestart = true
startretries = 3
user = root
redirect_stderr = true
stdout_logfile = /var/log/cesi1.log
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¼€å¯ä»»åŠ¡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;supervisorctl start cesi
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é»˜è®¤è´¦å·å¯†ç ï¼šadmin,admin ç«¯å£éœ€è¦æ”¹çš„è‡ªå·±å»web.pyé‡Œé¢æ”¹ you get it&lt;/p&gt;
&lt;p&gt;æœ¬æµ‹è¯•æœåœ°å€ï¼š &lt;a class="link" href="http://cesi.calmkart.com" target="_blank" rel="noopener"
 &gt;http://cesi.calmkart.com&lt;/a&gt; æ­¤å¤–ï¼Œå…¶ä»–å¸¸ç”¨çš„supervisorç›¸å…³ç¬¬ä¸‰æ–¹å·¥å…·è¿˜æœ‰ suponoff gosuv&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å†å²è¯„è®º-3-æ¡"&gt;å†å²è¯„è®º (3 æ¡)
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ä»¥ä¸‹è¯„è®ºæ¥è‡ªåŸ WordPress ç«™ç‚¹ï¼Œä»…ä½œå­˜æ¡£å±•ç¤ºã€‚&lt;/em&gt;&lt;/p&gt;

 &lt;blockquote&gt;
 &lt;p&gt;&lt;strong&gt;qhh0205&lt;/strong&gt; (2018-07-18 23:00)&lt;/p&gt;
&lt;p&gt;ä½ å¥½ï¼Œcesi æ”¯æŒç®¡ç†å¤šä¸ªæœåŠ¡å™¨çš„è¿›ç¨‹å—ï¼Ÿæˆ‘çœ‹ä½ æˆªå›¾è²Œä¼¼æ”¯æŒç®¡ç†å¤šä¸ªæœåŠ¡å™¨çš„ã€‚æˆ‘ç”¨é»˜è®¤çš„supervisor web UIï¼Œä¸æ”¯æŒç®¡ç†å¤šä¸ªæœåŠ¡å™¨çš„supervisorã€‚&lt;/p&gt;

 &lt;/blockquote&gt;

 &lt;blockquote&gt;
 &lt;p&gt;â†³ &lt;strong&gt;qhh0205&lt;/strong&gt; (2018-07-18 23:26)&lt;/p&gt;
&lt;p&gt;sorryï¼Œåˆšæ²¡ä»”ç»†çœ‹ï¼Œæ˜¯æ”¯æŒçš„&lt;/p&gt;

 &lt;/blockquote&gt;

 &lt;blockquote&gt;
 &lt;p&gt;&lt;strong&gt;potoo&lt;/strong&gt; (2019-05-19 16:49)&lt;/p&gt;
&lt;p&gt;ä½ å¥½ï¼Œæˆ‘çœ‹ä½ æä¾›çš„&lt;a class="link" href="http://cesi.calmkart.com" target="_blank" rel="noopener"
 &gt;æµ‹è¯•åœ°å€&lt;/a&gt;çš„ web æ•ˆæœä¸ä¸€æ ·ï¼Œæ˜¯ä½ è‡ªå·±ä¿®æ”¹äº†å—? ä½ å¯ä»¥è¯´ä¸‹ä¿®æ”¹çš„æ–¹æ³•å—ï¼Ÿ æˆ‘ä¹Ÿåœ¨ç”¨ cesiï¼Œä½†æ˜¯ cesi ç§»åŠ¨ç«¯é¡µé¢æ˜¾ç¤ºæœ‰é—®é¢˜ï¼Œæƒ³è‡ªå·±ä¿®æ”¹ä¸‹é¡µé¢ï¼Œä½†æ˜¯ä¸çŸ¥é“åœ¨å“ªé‡Œä¿®æ”¹ã€‚&lt;/p&gt;

 &lt;/blockquote&gt;</description></item><item><title>ä¿®æ”¹saltæºç å®ç°jobs.list_jobsåŠ å¯†è´¦å·å¯†ç </title><link>https://www.calmkart.com/posts/2017/12/2017-12-18-%E4%BF%AE%E6%94%B9salt%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0jobs-list_jobs%E5%8A%A0%E5%AF%86%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/</link><pubDate>Mon, 18 Dec 2017 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2017/12/2017-12-18-%E4%BF%AE%E6%94%B9salt%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0jobs-list_jobs%E5%8A%A0%E5%AF%86%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/</guid><description>&lt;p&gt;åœ¨salt masterä¸­ä¸ºå„ä¸ªminionè¿è¡Œå„ç§å‘½ä»¤ï¼Œå½“è¾“å…¥å‘½ä»¤ä¸­æ˜¾å¼å¸¦æœ‰è´¦å·å¯†ç æ—¶ï¼Œå¯ä»¥åœ¨masterç«¯é€šè¿‡ salt.runners.jobs.last_run() salt.runners.jobs.list_job() salt.runners.jobs.list_jobs() salt.runners.jobs.list_jobs_filter() ç­‰ç§ç§æ–¹æ³•æŸ¥çœ‹åˆ°è´¦å·å¯†ç ï¼Œè¿™æ ·å°±ä¼šæœ‰å®‰å…¨é£é™©ã€‚ æ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹saltæºç çš„æ–¹å¼å®ç°å¯¹æ˜¾ç¤ºå¯†ç çš„è®°å½•åŠ å¯†ã€‚æœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾ï¼š &lt;img src="images/zzxg.jpg" alt="" /&gt;
&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹æ–¹æ³•å¾ˆç®€å•ï¼Œé¦–å…ˆæ‰¾åˆ°ç³»ç»Ÿä¸­çš„saltæ–‡ä»¶å¤¹ï¼Œæœ¬æµ‹è¯•æœºåœ¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/usr/lib/python2.7/dist-packages/salt/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¿®æ”¹./runners/jobs.pyæ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#æ·»åŠ å‡½æ•°,è¿™é‡Œä¸»è¦æ˜¯æ­£åˆ™åŒ¹é…ï¼Œå¯ä»¥åŒ¹é…æ›´å¤šçš„passé€‰é¡¹ï¼Œå®ç°æ›´å¤šçš„éšè—å¯†ç 
import re
def encry_pass(target):
 result = re.sub(r&amp;#34;(?&amp;lt;=--password )\w+&amp;#34;, &amp;#34;*&amp;#34;, target)
 return result
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¹¶åœ¨list_job()å‡½æ•°ï¼Œlist_jobs()å‡½æ•°ï¼Œlist_jobs_filter()å‡½æ•°ï¼Œprint_job()å‡½æ•°æœ«å°¾åˆ†åˆ«åŠ å…¥å¦‚ä¸‹ä»£ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#list_job()
ret = eval(encry_pass(str(ret))) #å¢åŠ æ­¤è¡Œ
return ret

#list_jobs()
mret = eval(encry_pass(str(mret))) #å¢åŠ æ­¤è¡Œ
return mret

#list_jobs_filter()
ret = eval(encry_pass(str(ret))) #å¢åŠ æ­¤è¡Œ 
return ret

#print_job()
ret = eval(encry_pass(str(ret))) #å¢åŠ æ­¤è¡Œ
return ret
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æå®š&lt;/p&gt;
&lt;p&gt;ä¸€ç‚¹å°è¡¥å……ï¼š ä¸ºä»€ä¹ˆè¦ç”¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;ret = eval(encry_pass(str(ret)))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å› ä¸ºretæ˜¯dictç±»å‹ï¼Œå¾—å…ˆæŠŠdictç±»å‹è½¬æ¢æˆstrç±»å‹å†å†™å…¥encry_pass()æ­£åˆ™åŒ¹é…å‡½æ•°çš„å‚æ•°é‡Œï¼Œç„¶åencry_pass()æ­£åˆ™åŒ¹é…å‡½æ•°è¿”å›ä¸€ä¸ªstrå¯¹è±¡ï¼Œè€Œretéœ€è¦çš„æ˜¯dictå¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦å†ç”¨eval()è½¬å›æ¥,ä¹Ÿå°±æ˜¯ ret(dict)&amp;mdash;-&amp;gt;str(ret)&amp;mdash;&amp;ndash;&amp;gt;ret(str)&amp;mdash;&amp;ndash;&amp;gt;result(str)&amp;mdash;&amp;ndash;&amp;gt;eval(result)&amp;mdash;&amp;ndash;&amp;gt;result(dict)&amp;mdash;&amp;ndash;&amp;gt;ret(dict)&lt;/p&gt;</description></item><item><title>NFSæ­å»ºåŠç«¯å£å®‰å…¨æ§åˆ¶</title><link>https://www.calmkart.com/posts/2017/12/2017-12-05-nfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E7%AB%AF%E5%8F%A3%E5%AE%89%E5%85%A8%E6%8E%A7%E5%88%B6/</link><pubDate>Tue, 05 Dec 2017 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2017/12/2017-12-05-nfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E7%AB%AF%E5%8F%A3%E5%AE%89%E5%85%A8%E6%8E%A7%E5%88%B6/</guid><description>&lt;p&gt;NFSæœåŠ¡ç”¨äºæ–‡ä»¶åˆ†äº«å’Œæ–‡ä»¶åŒæ­¥ï¼ŒåŠŸèƒ½å°±ä¸æè¿°äº†ï¼Œæ¶æ„æ˜¯C/Sçš„æ¨¡å¼&lt;/p&gt;
&lt;p&gt;ä¸€.ç®€å•é…ç½®&lt;/p&gt;
&lt;p&gt;1.æœåŠ¡ç«¯&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt install nfs-kernel-server
vi /etc/exports
########æ·»åŠ å¦‚ä¸‹#######
/opt/nfs *(ro,sync,no_subtree_check)
#NFSå…±äº«è·¯å¾„ IP(åªè¯»ï¼ŒåŒæ­¥ï¼Œä¸æ£€æŸ¥çˆ¶ç›®å½•)
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;service nfs-kernel-server restart 
service rpcbind restart
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æµ‹è¯•ï¼šshowmount -e&lt;/p&gt;
&lt;p&gt;2.å®¢æˆ·ç«¯&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get install nfs-common
mount è¿œç¨‹nfs_ip:/è·¯å¾„ /æœ¬åœ°è·¯å¾„
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Â &lt;/p&gt;
&lt;p&gt;äºŒ.NFSæœåŠ¡ç«¯å£æ§åˆ¶&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç«¯é…ç½®ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# /etc/default/nfs-common
 STATDOPTS=&amp;#34;--port 32765 --outgoing-port 32766&amp;#34;

 # /etc/default/nfs-kernel-server
 RPCMOUNTDOPTS=&amp;#34;-p 32767&amp;#34;

 # /etc/default/quota
 RPCRQUOTADOPTS=&amp;#34;-p 32769&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt; # /etc/sysctl.conf
fs.nfs.nfs_callback_tcpport = 32764
fs.nfs.nlm_tcpport = 32768
fs.nfs.nlm_udpport = 32768
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;sysctl --system
service nfs-kernel-server restart
service rpcbind restart
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆ™å¯ä»¥å°†æœåŠ¡ç«¯ç«¯å£é™åˆ¶ä¸º:&lt;/p&gt;
&lt;p&gt;2049,111,32764-32769 TCP/UDP&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å†å²è¯„è®º-1-æ¡"&gt;å†å²è¯„è®º (1 æ¡)
&lt;/h2&gt;&lt;p&gt;&lt;em&gt;ä»¥ä¸‹è¯„è®ºæ¥è‡ªåŸ WordPress ç«™ç‚¹ï¼Œä»…ä½œå­˜æ¡£å±•ç¤ºã€‚&lt;/em&gt;&lt;/p&gt;

 &lt;blockquote&gt;
 &lt;p&gt;&lt;strong&gt;å­™æ˜Š&lt;/strong&gt; (2017-12-05 16:49)&lt;/p&gt;
&lt;p&gt;æˆ‘æ—¥ï¼Œå½­æ€»å±Œç‚¸äº†&lt;/p&gt;

 &lt;/blockquote&gt;</description></item><item><title>saltstackçš„å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨</title><link>https://www.calmkart.com/posts/2017/11/2017-11-29-saltstack%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</link><pubDate>Wed, 29 Nov 2017 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2017/11/2017-11-29-saltstack%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</guid><description>&lt;p&gt;saltstackå¯ç”¨äºæ‰¹é‡ç®¡ç†é›†ç¾¤,ç”¨çš„æ˜¯c/sæ¶æ„ï¼Œmasterç®¡ç†å¤šä¸ªminion&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ç³»ç»Ÿï¼šdebian8.7&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€.å®‰è£…master&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.æ·»åŠ apt key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;wget -O - https://repo.saltstack.com/apt/debian/8/amd64/latest/SALTSTACK-GPG-KEY.pub | sudo apt-key add -
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2.å°†saltstackæºæ·»åŠ è¿›aptæº&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;vi /etc/apt/sources.list
#æ·»åŠ saltstackæº
deb http://repo.saltstack.com/apt/debian/8/amd64/latest jessie main
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3.æ›´æ–°apt&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4.å®‰è£…masterç«¯ç›¸å…³ç»„ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get install salt-api
apt-get install salt-cloud
apt-get install salt-master
apt-get install salt-minion
apt-get install salt-ssh
apt-get install salt-syndic
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5.é…ç½®master&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;vi /etc/salt/master
####################å¸¸è§é…ç½®å¦‚ä¸‹####################
#æŒ‡å®šmasterï¼Œå†’å·åæœ‰ä¸€ä¸ªç©ºæ ¼
user: root
#è‡ªåŠ¨æ¥æ”¶minion
auto_accept: True

#-------ä»¥ä¸‹ä¸ºå¯é€‰--------------
#è‡ªåŠ¨æ¥æ”¶minion
auto_accept: True
#saltçš„è¿è¡Œçº¿ç¨‹ï¼Œå¼€çš„çº¿ç¨‹è¶Šå¤šä¸€èˆ¬å¤„ç†çš„é€Ÿåº¦è¶Šå¿«ï¼Œä½†ä¸€èˆ¬ä¸è¦è¶…è¿‡CPUçš„ä¸ªæ•°
worker_threads: 10
# masterçš„ç®¡ç†ç«¯å£
publish_port : 4505
# masterè·Ÿminionçš„é€šè®¯ç«¯å£ï¼Œç”¨äºæ–‡ä»¶æœåŠ¡ï¼Œè®¤è¯ï¼Œæ¥å—è¿”å›ç»“æœç­‰
ret_port : 4506
# å¦‚æœè¿™ä¸ªmasterè¿è¡Œçš„salt-syndicè¿æ¥åˆ°äº†ä¸€ä¸ªæ›´é«˜å±‚çº§çš„master,é‚£ä¹ˆè¿™ä¸ªå‚æ•°éœ€è¦é…ç½®æˆè¿æ¥åˆ°çš„è¿™ä¸ªé«˜å±‚çº§masterçš„ç›‘å¬ç«¯å£
syndic_master_port : 4506
# æŒ‡å®špidæ–‡ä»¶ä½ç½®
pidfile: /var/run/salt-master.pid
# saltstack å¯ä»¥æ§åˆ¶çš„æ–‡ä»¶ç³»ç»Ÿçš„å¼€å§‹ä½ç½®
root_dir: /
# æ—¥å¿—æ–‡ä»¶åœ°å€
log_file: /var/log/salt_master.log
# åˆ†ç»„è®¾ç½®
nodegroups:
 group_all: &amp;#39;*&amp;#39;
# salt stateæ‰§è¡Œæ—¶å€™çš„æ ¹ç›®å½•
file_roots:
 base:
 - /srv/salt/
# è®¾ç½®pillar çš„æ ¹ç›®å½•
pillar_roots:
 base:
 - /srv/pillar
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;6.å¯åŠ¨master&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;systemctl start salt-master
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;äºŒ.å®‰è£…minion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.å®‰è£…salt-minion&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;apt-get install salt-minion
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2.é…ç½®minionç›¸å…³ä¿¡æ¯&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;vi /etc/salt/minion

###################ä»¥ä¸‹ä¸ºå¸¸è§è®¾ç½®###########################
#æŒ‡å®šmasterï¼Œå†’å·åæœ‰ä¸€ä¸ªç©ºæ ¼
master: 10.32.80.121

#-------ä»¥ä¸‹ä¸ºå¯é€‰--------------
# minionçš„è¯†åˆ«IDï¼Œå¯ä»¥æ˜¯IPï¼ŒåŸŸåï¼Œæˆ–æ˜¯å¯ä»¥é€šè¿‡DNSè§£æçš„å­—ç¬¦ä¸²
id: xx
# saltè¿è¡Œçš„ç”¨æˆ·æƒé™
user: root
# masterçš„è¯†åˆ«IDï¼Œå¯ä»¥æ˜¯IPï¼ŒåŸŸåï¼Œæˆ–æ˜¯å¯ä»¥é€šè¿‡DNSè§£æçš„å­—ç¬¦ä¸²
master : ip
# masteré€šè®¯ç«¯å£
master_port: 4506
# å¤‡ä»½æ¨¡å¼ï¼Œminionæ˜¯æœ¬åœ°å¤‡ä»½ï¼Œå½“è¿›è¡Œæ–‡ä»¶ç®¡ç†æ—¶çš„æ–‡ä»¶å¤‡ä»½æ¨¡å¼
backup_mode: minion
# æ‰§è¡Œsalt-callæ—¶å€™çš„è¾“å‡ºæ–¹å¼
output: nested 
# minionç­‰å¾…masteræ¥å—è®¤è¯çš„æ—¶é—´
acceptance_wait_time: 10
# å¤±è´¥é‡è¿æ¬¡æ•°ï¼Œ0è¡¨ç¤ºæ— é™æ¬¡ï¼Œéé›¶ä¼šä¸æ–­å°è¯•åˆ°è®¾ç½®å€¼ååœæ­¢å°è¯•
acceptance_wait_time_max: 0
# é‡æ–°è®¤è¯å»¶è¿Ÿæ—¶é—´ï¼Œå¯ä»¥é¿å…å› ä¸ºmasterçš„keyæ”¹å˜å¯¼è‡´minionéœ€è¦é‡æ–°è®¤è¯çš„syné£æš´
random_reauth_delay: 60
# æ—¥å¿—æ–‡ä»¶ä½ç½®
log_file: /var/logs/salt_minion.log
# æ–‡ä»¶è·¯å¾„åŸºæœ¬ä½ç½®
file_roots:
 base:
 - /etc/salt/minion/file
# pillaråŸºæœ¬ä½ç½®
pillar_roots:
 base:
 - /data/salt/minion/pillar
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3.å¯åŠ¨minion&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;systemctl start salt-minion
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;ä¸‰.é€šè¿‡masterç®¡ç†minion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.é…ç½®key&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„key
salt-key

#æ³¨å†Œæ‰€æœ‰key
salt-key -A

#æ³¨å†ŒæŸä¸ªkey
salt-key -a minion_id

#åˆ é™¤å…¨éƒ¨key
salt-key -D

#åˆ é™¤æŸä¸ªkey
salt-key -d minion_id
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2.æµ‹è¯•æ˜¯å¦è¿é€š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#æµ‹è¯•æ‰€æœ‰minionçš„è¿é€šæ€§
salt &amp;#39;*&amp;#39; test.ping

#æµ‹è¯•æŸä¸ªminionçš„è¿é€šæ€§
salt &amp;#39;minion_id&amp;#39; test.ping
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3.å¸¸ç”¨å‘½ä»¤&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;#salt cmd.runç”¨äºè®©minionæ‰¹é‡æ‰§è¡Œå‘½ä»¤
salt &amp;#39;*&amp;#39; cmd.run &amp;#39;ifconfig&amp;#39;
salt &amp;#39;minion_id&amp;#39; cmd.run &amp;#39;ifconfig&amp;#39;

#salt-run manageæŸ¥çœ‹minioniä¿¡æ¯
salt-run manage.status #æŸ¥çœ‹æ‰€æœ‰minionçŠ¶æ€
salt-run manage.down ##æŸ¥çœ‹downæ‰çš„minion
salt-run manage.up ##æŸ¥çœ‹upçš„minion

#salt-keyç®¡ç†å¯†é’¥
salt-key [options]
salt-key -L ##æŸ¥çœ‹æ‰€æœ‰minion-key
salt-key -a &amp;lt;key-name&amp;gt; ##æ¥å—æŸä¸ªminion-key
salt-key -d &amp;lt;key-name&amp;gt; ##åˆ é™¤æŸä¸ªminion-key
salt-key -A ##æ¥å—æ‰€æœ‰çš„minion-key
salt-key -D ##åˆ é™¤æ‰€æœ‰çš„minion-key

#salt-callåœ¨minionä¸Šæ‰§è¡ŒæŸå‘½ä»¤
salt-call [options] &amp;lt;function&amp;gt; [arguments]
salt-call test.ping ##è‡ªå·±æ‰§è¡Œtest.pingå‘½ä»¤
salt-call cmd.run &amp;#39;ifconfig&amp;#39; ##è‡ªå·±æ‰§è¡Œcmd.runå‡½æ•°

#salt-cpåˆ†å‘æ–‡ä»¶ç»™minion(ä¸æ”¯æŒç›®å½•åˆ†å‘)
salt-cp &amp;#39;*&amp;#39; testfile.html /tmp #æŠŠtestfile.htmlå‘é€åˆ°æ‰€æœ‰minionçš„/tmpæ–‡ä»¶å¤¹
salt-cp &amp;#39;test*&amp;#39; index.html /tmp/a.html #æŠŠindex.htmlå‘é€åˆ°æ‰€æœ‰test*çš„minionå¹¶é‡å‘½åä¸º/tmp/a.html

#ç›®æ ‡minionåˆ†ç»„
ä¿®æ”¹/etc/salt/master
nodegroups:
 testgroup1: &amp;#39;L@test82.salt.cn,test83.salt.cn&amp;#39;
 testgroup2: &amp;#39;192.168.2.84&amp;#39;
#-Nä¸ºåˆ†ç»„å‘½ä»¤ç¬¦
salt -N testgroup1 test.ping
#åˆ†ç»„åˆ†ä¸ºå¤šç§ç±»å‹ï¼š
 G -- é’ˆå¯¹ Grains åšå•ä¸ªåŒ¹é…ï¼Œä¾‹å¦‚ï¼šG@os:Ubuntu
 E -- é’ˆå¯¹ minion é’ˆå¯¹æ­£åˆ™è¡¨è¾¾å¼åšåŒ¹é…ï¼Œä¾‹å¦‚ï¼šE@web\d+.(dev|qa|prod).loc
 P -- é’ˆå¯¹ Grains åšæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œä¾‹å¦‚ï¼šP@os:(RedHat|Fedora|CentOS)
 L -- é’ˆå¯¹ minion åšåˆ—è¡¨åŒ¹é…ï¼Œä¾‹å¦‚ï¼šL@minion1.example.com,minion3.domain.com or bl*.domain.com
 I -- é’ˆå¯¹ Pillar åšå•ä¸ªåŒ¹é…ï¼Œä¾‹å¦‚ï¼šI@pdata:foobar
 S -- é’ˆå¯¹å­ç½‘æˆ–æ˜¯ IP åšåŒ¹é…ï¼Œä¾‹å¦‚ï¼šS@192.168.1.0/24 or S@192.168.1.100
 R -- é’ˆå¯¹å®¢æˆ·ç«¯èŒƒå›´åšåŒ¹é…ï¼Œä¾‹å¦‚ï¼š R@%foo.bar
&lt;/code&gt;&lt;/pre&gt;</description></item></channel></rss>