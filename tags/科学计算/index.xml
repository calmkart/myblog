<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>科学计算 on cAlm的个人Blog</title><link>https://www.calmkart.com/tags/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97/</link><description>Recent content in 科学计算 on cAlm的个人Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 12 Oct 2018 00:00:00 +0000</lastBuildDate><atom:link href="https://www.calmkart.com/tags/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97/index.xml" rel="self" type="application/rss+xml"/><item><title>增量计算海量数据均值,方差,标准差</title><link>https://www.calmkart.com/posts/2018/10/2018-10-12-%E5%A2%9E%E9%87%8F%E8%AE%A1%E7%AE%97%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E6%A0%87%E5%87%86%E5%B7%AE/</link><pubDate>Fri, 12 Oct 2018 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2018/10/2018-10-12-%E5%A2%9E%E9%87%8F%E8%AE%A1%E7%AE%97%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%9D%87%E5%80%BC%E6%96%B9%E5%B7%AE%E6%A0%87%E5%87%86%E5%B7%AE/</guid><description>&lt;p&gt;最近需要从海量数据中获取均值,方差,标准差&lt;/p&gt;
&lt;p&gt;显然直接读如内存中按公式做肯定是gg的,于是考虑是否可以增量计算&lt;/p&gt;
&lt;p&gt;最终写了一个增量计算海量数据均值方差标准差的python通用类&lt;/p&gt;
&lt;p&gt;参考了以下公式推导:&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://www.calmkart.com/wp-content/uploads/2018/10/canvas.png" target="_blank" rel="noopener"
 &gt;&lt;img src="images/canvas.png" alt="" /&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;代码如下:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# -*- coding: utf-8 -*-
from __future__ import division
import numpy

class incre_std_avg():
 &amp;#39;&amp;#39;&amp;#39;
 增量计算海量数据平均值和标准差,方差
 1.数据
 obj.avg为平均值
 obj.std为标准差
 obj.n为数据个数
 对象初始化时需要指定历史平均值,历史标准差和历史数据个数(初始数据集为空则可不填写)
 2.方法
 obj.incre_in_list()方法传入一个待计算的数据list,进行增量计算,获得新的avg,std和n(海量数据请循环使用该方法)
 obj.incre_in_value()方法传入一个待计算的新数据,进行增量计算,获得新的avg,std和n(海量数据请将每个新参数循环带入该方法)
 &amp;#39;&amp;#39;&amp;#39;

 def __init__(self, h_avg=0, h_std=0, n=0):
 self.avg = h_avg
 self.std = h_std
 self.n = n

 def incre_in_list(self, new_list):
 avg_new = numpy.mean(new_list)
 incre_avg = (self.n*self.avg+len(new_list)*avg_new) / \
 (self.n+len(new_list))
 std_new = numpy.std(new_list)
 incre_std = numpy.sqrt((self.n*(self.std**2+(incre_avg-self.avg)**2)+len(new_list)
 * (std_new**2+(incre_avg-avg_new)**2))/(self.n+len(new_list)))
 self.avg = incre_avg
 self.std = incre_std
 self.n += len(new_list)

 def incre_in_value(self, value):
 incre_avg = (self.n*self.avg+value)/(self.n+1)
 incre_std = numpy.sqrt((self.n*(self.std**2+(incre_avg-self.avg)
 ** 2)+(incre_avg-value)**2)/(self.n+1))
 self.avg = incre_avg
 self.std = incre_std
 self.n += 1

if __name__ == &amp;#34;__main__&amp;#34;:
 c = incre_std_avg()
 c.incre_in_value(0.05)
 print c.avg
 print c.std
 print c.n
 c.incre_in_value(0.02)
 c.incre_in_list([0.5, 0.2, 0.3])
 print c.avg
 print c.std
 print c.n
&lt;/code&gt;&lt;/pre&gt;</description></item></channel></rss>