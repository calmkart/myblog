<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>加密 on cAlm的个人Blog</title><link>https://www.calmkart.com/tags/%E5%8A%A0%E5%AF%86/</link><description>Recent content in 加密 on cAlm的个人Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 28 Sep 2018 00:00:00 +0000</lastBuildDate><atom:link href="https://www.calmkart.com/tags/%E5%8A%A0%E5%AF%86/index.xml" rel="self" type="application/rss+xml"/><item><title>python操作rsa和aes加解密</title><link>https://www.calmkart.com/posts/2018/09/2018-09-28-python%E6%93%8D%E4%BD%9Crsa%E5%92%8Caes%E5%8A%A0%E8%A7%A3%E5%AF%86/</link><pubDate>Fri, 28 Sep 2018 00:00:00 +0000</pubDate><guid>https://www.calmkart.com/posts/2018/09/2018-09-28-python%E6%93%8D%E4%BD%9Crsa%E5%92%8Caes%E5%8A%A0%E8%A7%A3%E5%AF%86/</guid><description>&lt;p&gt;封装了一个python的操作rsa和aes的加解密类&lt;/p&gt;
&lt;p&gt;首先pip装库&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;pip install pycrypto
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后代码如下&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# -*- coding:utf-8 -*-
import base64
from Crypto import Random
from Crypto.Hash import SHA
from Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5
from Crypto.Signature import PKCS1_v1_5 as Signature_pkcs1_v1_5
from Crypto.PublicKey import RSA
from Crypto.Cipher import AES
from binascii import b2a_hex, a2b_hex

#AES加解密,用于本地加密数据库密码和rsa private key
aes_salt = &amp;#34;opquweoijuqowieh&amp;#34;
class Aes():
 
 def __init__(self, key=aes_salt):
 self.key = key
 self.mode = AES.MODE_CBC

 def encrypt(self, text):
 cryptor = AES.new(self.key, self.mode, b&amp;#39;0000000000000000&amp;#39;)
 length = 16
 count = len(text)
 if count &amp;lt; length: add = (length-count) text = text + (&amp;#39;\0&amp;#39; * add) elif count &amp;gt; length:
 add = (length-(count % length))
 text = text + (&amp;#39;\0&amp;#39; * add)
 self.ciphertext = cryptor.encrypt(text)
 return b2a_hex(self.ciphertext)

 def decrypt(self, text):
 cryptor = AES.new(self.key, self.mode, b&amp;#39;0000000000000000&amp;#39;)
 plain_text = cryptor.decrypt(a2b_hex(text))
 return plain_text.rstrip(&amp;#39;\0&amp;#39;)

#rsa加解密,用于cookie的加解密
class Rsa():
 
 def __init__(self):
 self.random_generator = Random.new().read

 def gen_rsa_keys(self):
 rsa = RSA.generate(1024, self.random_generator)
 private_pem = rsa.exportKey()
 public_pem = rsa.publickey().exportKey()
 return (private_pem, public_pem)

 def crypto(self, public_key, text):
 rsakey = RSA.importKey(public_key)
 cipher = Cipher_pkcs1_v1_5.new(rsakey)
 crypto_text = base64.b64encode(cipher.encrypt(text))
 return crypto_text

 def decrypt(self, private_key, text):
 rsakey = RSA.importKey(private_key)
 cipher = Cipher_pkcs1_v1_5.new(rsakey)
 decrypt_text = cipher.decrypt(base64.b64decode(
 text), self.random_generator)
 return decrypt_text

if __name__ == &amp;#39;__main__&amp;#39;:
 rsa = Rsa()
 aes = Aes()
 (pri,pub)=rsa.gen_rsa_keys()
 jm = rsa.crypto(pub, &amp;#34;pengng|||||123908123.123123&amp;#34;)
 print rsa.decrypt(pri, jm)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;调用方法&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;rsa = Rsa()
aes = Aes()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;代码注释写得非常详细，细节就不赘述了，做个备忘&lt;/p&gt;</description></item></channel></rss>