<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>密码 on cAlm的个人Blog</title>
        <link>http://localhost:1313/tags/%E5%AF%86%E7%A0%81/</link>
        <description>Recent content in 密码 on cAlm的个人Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Fri, 28 Sep 2018 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/tags/%E5%AF%86%E7%A0%81/index.xml" rel="self" type="application/rss+xml" /><item>
            <title>python操作rsa和aes加解密</title>
            <link>http://localhost:1313/posts/2018/09/2018-09-28-python%E6%93%8D%E4%BD%9Crsa%E5%92%8Caes%E5%8A%A0%E8%A7%A3%E5%AF%86/</link>
            <pubDate>Fri, 28 Sep 2018 00:00:00 +0000</pubDate>
            <guid>http://localhost:1313/posts/2018/09/2018-09-28-python%E6%93%8D%E4%BD%9Crsa%E5%92%8Caes%E5%8A%A0%E8%A7%A3%E5%AF%86/</guid>
            <description>&lt;p&gt;封装了一个python的操作rsa和aes的加解密类&lt;/p&gt;&#xA;&lt;p&gt;首先pip装库&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;pip install pycrypto&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后代码如下&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# -*- coding:utf-8 -*-&#xA;import base64&#xA;from Crypto import Random&#xA;from Crypto.Hash import SHA&#xA;from Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5&#xA;from Crypto.Signature import PKCS1_v1_5 as Signature_pkcs1_v1_5&#xA;from Crypto.PublicKey import RSA&#xA;from Crypto.Cipher import AES&#xA;from binascii import b2a_hex, a2b_hex&#xA;&#xA;#AES加解密,用于本地加密数据库密码和rsa private key&#xA;aes_salt = &amp;#34;opquweoijuqowieh&amp;#34;&#xA;class Aes():&#xA;    &#xA;    def __init__(self, key=aes_salt):&#xA;        self.key = key&#xA;        self.mode = AES.MODE_CBC&#xA;&#xA;    def encrypt(self, text):&#xA;        cryptor = AES.new(self.key, self.mode, b&amp;#39;0000000000000000&amp;#39;)&#xA;        length = 16&#xA;        count = len(text)&#xA;        if count &amp;lt; length: add = (length-count) text = text + (&amp;#39;\0&amp;#39; * add) elif count &amp;gt; length:&#xA;            add = (length-(count % length))&#xA;            text = text + (&amp;#39;\0&amp;#39; * add)&#xA;        self.ciphertext = cryptor.encrypt(text)&#xA;        return b2a_hex(self.ciphertext)&#xA;&#xA;    def decrypt(self, text):&#xA;        cryptor = AES.new(self.key, self.mode, b&amp;#39;0000000000000000&amp;#39;)&#xA;        plain_text = cryptor.decrypt(a2b_hex(text))&#xA;        return plain_text.rstrip(&amp;#39;\0&amp;#39;)&#xA;&#xA;#rsa加解密,用于cookie的加解密&#xA;class Rsa():&#xA;    &#xA;    def __init__(self):&#xA;        self.random_generator = Random.new().read&#xA;&#xA;    def gen_rsa_keys(self):&#xA;        rsa = RSA.generate(1024, self.random_generator)&#xA;        private_pem = rsa.exportKey()&#xA;        public_pem = rsa.publickey().exportKey()&#xA;        return (private_pem, public_pem)&#xA;&#xA;    def crypto(self, public_key, text):&#xA;        rsakey = RSA.importKey(public_key)&#xA;        cipher = Cipher_pkcs1_v1_5.new(rsakey)&#xA;        crypto_text = base64.b64encode(cipher.encrypt(text))&#xA;        return crypto_text&#xA;&#xA;    def decrypt(self, private_key, text):&#xA;        rsakey = RSA.importKey(private_key)&#xA;        cipher = Cipher_pkcs1_v1_5.new(rsakey)&#xA;        decrypt_text = cipher.decrypt(base64.b64decode(&#xA;            text), self.random_generator)&#xA;        return decrypt_text&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    rsa = Rsa()&#xA;    aes = Aes()&#xA;    (pri,pub)=rsa.gen_rsa_keys()&#xA;    jm = rsa.crypto(pub, &amp;#34;pengng|||||123908123.123123&amp;#34;)&#xA;    print rsa.decrypt(pri, jm)&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;调用方法&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rsa = Rsa()&#xA;aes = Aes()&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;代码注释写得非常详细，细节就不赘述了，做个备忘&lt;/p&gt;</description>
        </item></channel>
</rss>
