<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>类视图 on cAlm的个人Blog</title>
        <link>http://localhost:1313/tags/%E7%B1%BB%E8%A7%86%E5%9B%BE/</link>
        <description>Recent content in 类视图 on cAlm的个人Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Tue, 18 Sep 2018 00:00:00 +0000</lastBuildDate><atom:link href="http://localhost:1313/tags/%E7%B1%BB%E8%A7%86%E5%9B%BE/index.xml" rel="self" type="application/rss+xml" /><item>
            <title>django类视图装饰器</title>
            <link>http://localhost:1313/posts/2018/09/2018-09-18-django%E7%B1%BB%E8%A7%86%E5%9B%BE%E8%A3%85%E9%A5%B0%E5%99%A8/</link>
            <pubDate>Tue, 18 Sep 2018 00:00:00 +0000</pubDate>
            <guid>http://localhost:1313/posts/2018/09/2018-09-18-django%E7%B1%BB%E8%A7%86%E5%9B%BE%E8%A3%85%E9%A5%B0%E5%99%A8/</guid>
            <description>&lt;p&gt;一点关于django类视图装饰器的小笔记。&lt;/p&gt;&#xA;&lt;p&gt;django类视图是很常用的，对于传统的函数视图来说，装饰器可以直接装饰函数，但类视图，装饰器无法直接装饰类方法。&lt;/p&gt;&#xA;&lt;p&gt;比较了几种常见的解决方法,个人觉得比较优雅的解决方法如下：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from django.shortcuts import render&#xA;from django.utils.decorators import method_decorator&#xA;from django.views.decorators.csrf import csrf_exempt&#xA;from django.views.generic import View&#xA;&#xA;@method_decorator(csrf_exempt, name=&amp;#34;dispatch&amp;#34;)&#xA;class login(View):&#xA;&#xA;    @method_decorator(auth_login)&#xA;    def get(self, request, username):&#xA;        #....func...&#xA;        return render(request, &amp;#39;login.html&amp;#39;, {&amp;#34;displayName&amp;#34;:username, &amp;#34;admin_flag&amp;#34;:admin_flag})&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;既如以上代码，将装饰器函数传给method_decorator方法，直接修饰视图类方法。&lt;/p&gt;&#xA;&lt;p&gt;也可直接修饰视图类，对于需要修饰的方法，用name参数的形式传入method_decorator中即可，但感觉不够优雅。&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from django.shortcuts import render&#xA;from django.utils.decorators import method_decorator&#xA;from django.views.decorators.csrf import csrf_exempt&#xA;from django.views.generic import View&#xA;&#xA;@method_decorator(csrf_exempt, name=&amp;#34;dispatch&amp;#34;)&#xA;@method_decorator(auth_login, name=&amp;#34;get&amp;#34;)&#xA;class login(View):&#xA;&#xA;    def get(self, request, username):&#xA;        #....func...&#xA;        return render(request, &amp;#39;login.html&amp;#39;, {&amp;#34;displayName&amp;#34;:username, &amp;#34;admin_flag&amp;#34;:admin_flag})&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;需要稍微注意的是，csrf_exempt跨站排除装饰器，只能修饰在类视图的dispatch方法上，既原始写法如下：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;class login(View):&#xA;    &#xA;    @method_decorator(csrf_exempt)&#xA;    def dispatch(self, request, *args, **kwargs):&#xA;        return super(login,self).dispatch(request,*args,**kwargs)&#xA;    &#xA;    def get(self, request, username):&#xA;        #....func...&#xA;        return render(request, &amp;#39;login.html&amp;#39;, {&amp;#34;displayName&amp;#34;:username, &amp;#34;admin_flag&amp;#34;:admin_flag})&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但其实直接用类方法装饰器装饰视图类，传入参数name=dispatch就行了，不需要重写dispatch方法。&lt;/p&gt;&#xA;&lt;p&gt;既如上文。&lt;/p&gt;</description>
        </item></channel>
</rss>
